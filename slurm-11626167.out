add:2,sub:1
0 - SLURM_JOB_ID: 11626167
0 - SLURM_JOB_NODELIST: hpc-25-17
0 - SLURM_JOB_NUM_NODES: 1
0 - SLURM_NTASKS: 1
0 - SLURM_TASKS_PER_NODE: 1
0 - SLURM_MEM_PER_NODE: None
0 - SLURM_MEM_PER_CPU: 4096
0 - SLURM_NODEID: 0
0 - SLURM_PROCID: 0
0 - SLURM_LOCALID: 0
0 - SLURM_TASK_PID: 24120
add:2,sub:1
0 - SLURM_JOB_ID: 11626167
0 - SLURM_JOB_NODELIST: hpc-25-17
0 - SLURM_JOB_NUM_NODES: 1
0 - SLURM_NTASKS: 1
0 - SLURM_TASKS_PER_NODE: 1
0 - SLURM_MEM_PER_NODE: None
0 - SLURM_MEM_PER_CPU: 4096
0 - SLURM_NODEID: 0
0 - SLURM_PROCID: 0
0 - SLURM_LOCALID: 0
0 - SLURM_TASK_PID: 24120
add:2,sub:1
0 - SLURM_JOB_ID: 11626167
0 - SLURM_JOB_NODELIST: hpc-25-17
0 - SLURM_JOB_NUM_NODES: 1
0 - SLURM_NTASKS: 1
0 - SLURM_TASKS_PER_NODE: 1
0 - SLURM_MEM_PER_NODE: None
0 - SLURM_MEM_PER_CPU: 4096
0 - SLURM_NODEID: 0
0 - SLURM_PROCID: 0
0 - SLURM_LOCALID: 0
0 - SLURM_TASK_PID: 24120
add:2,sub:1
0 - SLURM_JOB_ID: 11626167
0 - SLURM_JOB_NODELIST: hpc-25-17
0 - SLURM_JOB_NUM_NODES: 1
0 - SLURM_NTASKS: 1
0 - SLURM_TASKS_PER_NODE: 1
0 - SLURM_MEM_PER_NODE: None
0 - SLURM_MEM_PER_CPU: 4096
0 - SLURM_NODEID: 0
0 - SLURM_PROCID: 0
0 - SLURM_LOCALID: 0
0 - SLURM_TASK_PID: 24120
0 - Master address: 127.0.0.1
0 - Master port   : 29500
3 - Number of nodes: 1
3 - Node ID					   : 0
3 - Local rank				   : 3
3 - Global rank    : 3
3 - World size				   : 4
3 - GPUs per node  : 4
3 - Master					   : False
3 - Multi-node				   : False
3 - Multi-GPU				   : True
3 - Hostname				   : hpc-25-17.cm.cluster
Initializing PyTorch distributed ...
0 - Master address: 127.0.0.1
0 - Master port   : 29500
1 - Number of nodes: 1
1 - Node ID					   : 0
1 - Local rank				   : 1
1 - Global rank    : 1
1 - World size				   : 4
1 - GPUs per node  : 4
1 - Master					   : False
1 - Multi-node				   : False
1 - Multi-GPU				   : True
1 - Hostname				   : hpc-25-17.cm.cluster
Initializing PyTorch distributed ...
0 - Master address: 127.0.0.1
0 - Master port   : 29500
0 - Number of nodes: 1
0 - Node ID					   : 0
0 - Local rank				   : 0
0 - Global rank    : 0
0 - World size				   : 4
0 - GPUs per node  : 4
0 - Master					   : True
0 - Multi-node				   : False
0 - Multi-GPU				   : True
0 - Hostname				   : hpc-25-17.cm.cluster
Initializing PyTorch distributed ...
0 - Master address: 127.0.0.1
0 - Master port   : 29500
2 - Number of nodes: 1
2 - Node ID					   : 0
2 - Local rank				   : 2
2 - Global rank    : 2
2 - World size				   : 4
2 - GPUs per node  : 4
2 - Master					   : False
2 - Multi-node				   : False
2 - Multi-GPU				   : True
2 - Hostname				   : hpc-25-17.cm.cluster
Initializing PyTorch distributed ...
INFO - 09/21/20 10:10:23 - 0:00:00 - ============ Initialized logger ============
INFO - 09/21/20 10:10:23 - 0:00:00 - accumulate_gradients: 1
                                     amp: -1
                                     attention_dropout: 0
                                     balanced: False
                                     batch_size: 64
                                     beam_early_stopping: True
                                     beam_eval: False
                                     beam_length_penalty: 1
                                     beam_size: 1
                                     character_rnn: True
                                     clean_prefix_expr: True
                                     clip_grad_norm: 5
                                     command: python main.py --local_rank=2 --exp_name treelstm_50k_numenc --emb_dim 128 --n_dec_layers 6 --n_heads 8 --dropout '0.1' --symmetric --treelstm --character_rnn --optimizer 'adam,lr=0.0001' --batch_size 64 --tasks prim_fwd --reload_data 'prim_fwd,fwd_small/fwd_small.train,fwd_small/fwd_small.valid,fwd_small/fwd_small.test' --reload_size 50000 --epoch_size 50000 --max_epoch 50 --exp_id "11626167"
                                     cpu: False
                                     debug: False
                                     debug_slurm: False
                                     dropout: 0.1
                                     dump_path: ./dumped/treelstm_50k_numenc/11626167
                                     emb_dim: 128
                                     env_base_seed: 0
                                     env_name: char_sp
                                     epoch_size: 50000
                                     eval_only: False
                                     eval_verbose: 0
                                     eval_verbose_print: False
                                     exp_id: 11626167
                                     exp_name: treelstm_50k_numenc
                                     export_data: False
                                     fp16: False
                                     global_rank: 2
                                     int_base: 10
                                     is_master: False
                                     is_slurm_job: True
                                     leaf_probs: 0.75,0,0.25,0
                                     local_rank: 2
                                     master_addr: 127.0.0.1
                                     master_port: 29500
                                     max_epoch: 50
                                     max_int: 10000
                                     max_len: 512
                                     max_ops: 10
                                     max_ops_G: 4
                                     multi_gpu: True
                                     multi_node: False
                                     n_coefficients: 0
                                     n_dec_layers: 6
                                     n_enc_layers: 4
                                     n_gpu_per_node: 4
                                     n_heads: 8
                                     n_nodes: 1
                                     n_variables: 1
                                     node_id: 0
                                     num_bit: 10
                                     num_workers: 10
                                     operators: add:2,sub:1
                                     optimizer: adam,lr=0.0001
                                     order: 1
                                     positive: False
                                     precision: 10
                                     reload_checkpoint: 
                                     reload_data: prim_fwd,fwd_small/fwd_small.train,fwd_small/fwd_small.valid,fwd_small/fwd_small.test
                                     reload_model: 
                                     reload_size: 50000
                                     rewrite_functions: 
                                     same_nb_ops_per_batch: False
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     stopping_criterion: 
                                     symmetric: True
                                     tasks: prim_fwd
                                     treelstm: True
                                     treesmu: False
                                     validation_metrics: 
                                     vars: 1
                                     world_size: 4
INFO - 09/21/20 10:10:23 - 0:00:00 - The experiment will be stored in ./dumped/treelstm_50k_numenc/11626167
                                     
INFO - 09/21/20 10:10:23 - 0:00:00 - Running command: python main.py --local_rank=2 --exp_name treelstm_50k_numenc --emb_dim 128 --n_dec_layers 6 --n_heads 8 --dropout '0.1' --symmetric --treelstm --character_rnn --optimizer 'adam,lr=0.0001' --batch_size 64 --tasks prim_fwd --reload_data 'prim_fwd,fwd_small/fwd_small.train,fwd_small/fwd_small.valid,fwd_small/fwd_small.test' --reload_size 50000 --epoch_size 50000 --max_epoch 50

WARNING - 09/21/20 10:10:23 - 0:00:00 - Signal handler installed.
dict_items([('add', 2), ('sub', 2), ('mul', 2), ('div', 2), ('pow', 2), ('rac', 2), ('inv', 1), ('pow2', 1), ('pow3', 1), ('pow4', 1), ('pow5', 1), ('sqrt', 1), ('exp', 1), ('ln', 1), ('abs', 1), ('sign', 1), ('sin', 1), ('cos', 1), ('tan', 1), ('cot', 1), ('sec', 1), ('csc', 1), ('asin', 1), ('acos', 1), ('atan', 1), ('acot', 1), ('asec', 1), ('acsc', 1), ('sinh', 1), ('cosh', 1), ('tanh', 1), ('coth', 1), ('sech', 1), ('csch', 1), ('asinh', 1), ('acosh', 1), ('atanh', 1), ('acoth', 1), ('asech', 1), ('acsch', 1), ('derivative', 2), ('f', 1), ('g', 2)])
INFO - 09/21/20 10:10:23 - 0:00:00 - Unary operators: ['inv', 'pow2', 'pow3', 'pow4', 'pow5', 'sqrt', 'exp', 'ln', 'abs', 'sign', 'sin', 'cos', 'tan', 'cot', 'sec', 'csc', 'asin', 'acos', 'atan', 'acot', 'asec', 'acsc', 'sinh', 'cosh', 'tanh', 'coth', 'sech', 'csch', 'asinh', 'acosh', 'atanh', 'acoth', 'asech', 'acsch', 'f']
INFO - 09/21/20 10:10:23 - 0:00:00 - Binary operators: ['add', 'sub', 'mul', 'div', 'pow', 'rac', 'derivative', 'g']
INFO - 09/21/20 10:10:23 - 0:00:00 - words: {'<s>': 0, '</s>': 1, '<pad>': 2, '(': 3, ')': 4, '<SPECIAL_5>': 5, '<SPECIAL_6>': 6, '<SPECIAL_7>': 7, '<SPECIAL_8>': 8, '<SPECIAL_9>': 9, 'pi': 10, 'E': 11, 'x': 12, 'y': 13, 'z': 14, 't': 15, 'a0': 16, 'a1': 17, 'a2': 18, 'a3': 19, 'a4': 20, 'a5': 21, 'a6': 22, 'a7': 23, 'a8': 24, 'a9': 25, 'abs': 26, 'acos': 27, 'acosh': 28, 'acot': 29, 'acoth': 30, 'acsc': 31, 'acsch': 32, 'add': 33, 'asec': 34, 'asech': 35, 'asin': 36, 'asinh': 37, 'atan': 38, 'atanh': 39, 'cos': 40, 'cosh': 41, 'cot': 42, 'coth': 43, 'csc': 44, 'csch': 45, 'derivative': 46, 'div': 47, 'exp': 48, 'f': 49, 'g': 50, 'inv': 51, 'ln': 52, 'mul': 53, 'pow': 54, 'pow2': 55, 'pow3': 56, 'pow4': 57, 'pow5': 58, 'rac': 59, 'sec': 60, 'sech': 61, 'sign': 62, 'sin': 63, 'sinh': 64, 'sqrt': 65, 'sub': 66, 'tan': 67, 'tanh': 68, 'I': 69, 'INT+': 70, 'INT-': 71, 'INT': 72, 'FLOAT': 73, '-': 74, '.': 75, '10^': 76, 'Y': 77, "Y'": 78, "Y''": 79, '0': 80, '1': 81, '2': 82, '3': 83, '4': 84, '5': 85, '6': 86, '7': 87, '8': 88, '9': 89}
INFO - 09/21/20 10:10:23 - 0:00:00 - 20001 possible leaves.
INFO - 09/21/20 10:10:23 - 0:00:00 - Checking expressions in [0.01, 0.1, 0.3, 0.5, 0.7, 0.9, 1.1, 2.1, 3.1, -0.01, -0.1, -0.3, -0.5, -0.7, -0.9, -1.1, -2.1, -3.1]
INFO - 09/21/20 10:10:23 - 0:00:00 - Training tasks: prim_fwd
/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/modules/rnn.py:50: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.1 and num_layers=1
  "num_layers={}".format(dropout, num_layers))
INFO - 09/21/20 10:10:23 - 0:00:00 - Number of parameters (encoder): 3688832
INFO - 09/21/20 10:10:23 - 0:00:00 - Number of parameters (decoder): 2123610
INFO - 09/21/20 10:10:24 - 0:00:00 - ============ Initialized logger ============
INFO - 09/21/20 10:10:24 - 0:00:00 - accumulate_gradients: 1
                                     amp: -1
                                     attention_dropout: 0
                                     balanced: False
                                     batch_size: 64
                                     beam_early_stopping: True
                                     beam_eval: False
                                     beam_length_penalty: 1
                                     beam_size: 1
                                     character_rnn: True
                                     clean_prefix_expr: True
                                     clip_grad_norm: 5
                                     command: python main.py --local_rank=3 --exp_name treelstm_50k_numenc --emb_dim 128 --n_dec_layers 6 --n_heads 8 --dropout '0.1' --symmetric --treelstm --character_rnn --optimizer 'adam,lr=0.0001' --batch_size 64 --tasks prim_fwd --reload_data 'prim_fwd,fwd_small/fwd_small.train,fwd_small/fwd_small.valid,fwd_small/fwd_small.test' --reload_size 50000 --epoch_size 50000 --max_epoch 50 --exp_id "11626167"
                                     cpu: False
                                     debug: False
                                     debug_slurm: False
                                     dropout: 0.1
                                     dump_path: ./dumped/treelstm_50k_numenc/11626167
                                     emb_dim: 128
                                     env_base_seed: 0
                                     env_name: char_sp
                                     epoch_size: 50000
                                     eval_only: False
                                     eval_verbose: 0
                                     eval_verbose_print: False
                                     exp_id: 11626167
                                     exp_name: treelstm_50k_numenc
                                     export_data: False
                                     fp16: False
                                     global_rank: 3
                                     int_base: 10
                                     is_master: False
                                     is_slurm_job: True
                                     leaf_probs: 0.75,0,0.25,0
                                     local_rank: 3
                                     master_addr: 127.0.0.1
                                     master_port: 29500
                                     max_epoch: 50
                                     max_int: 10000
                                     max_len: 512
                                     max_ops: 10
                                     max_ops_G: 4
                                     multi_gpu: True
                                     multi_node: False
                                     n_coefficients: 0
                                     n_dec_layers: 6
                                     n_enc_layers: 4
                                     n_gpu_per_node: 4
                                     n_heads: 8
                                     n_nodes: 1
                                     n_variables: 1
                                     node_id: 0
                                     num_bit: 10
                                     num_workers: 10
                                     operators: add:2,sub:1
                                     optimizer: adam,lr=0.0001
                                     order: 1
                                     positive: False
                                     precision: 10
                                     reload_checkpoint: 
                                     reload_data: prim_fwd,fwd_small/fwd_small.train,fwd_small/fwd_small.valid,fwd_small/fwd_small.test
                                     reload_model: 
                                     reload_size: 50000
                                     rewrite_functions: 
                                     same_nb_ops_per_batch: False
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     stopping_criterion: 
                                     symmetric: True
                                     tasks: prim_fwd
                                     treelstm: True
                                     treesmu: False
                                     validation_metrics: 
                                     vars: 1
                                     world_size: 4
INFO - 09/21/20 10:10:24 - 0:00:00 - The experiment will be stored in ./dumped/treelstm_50k_numenc/11626167
                                     
INFO - 09/21/20 10:10:24 - 0:00:00 - Running command: python main.py --local_rank=3 --exp_name treelstm_50k_numenc --emb_dim 128 --n_dec_layers 6 --n_heads 8 --dropout '0.1' --symmetric --treelstm --character_rnn --optimizer 'adam,lr=0.0001' --batch_size 64 --tasks prim_fwd --reload_data 'prim_fwd,fwd_small/fwd_small.train,fwd_small/fwd_small.valid,fwd_small/fwd_small.test' --reload_size 50000 --epoch_size 50000 --max_epoch 50

WARNING - 09/21/20 10:10:24 - 0:00:00 - Signal handler installed.
dict_items([('add', 2), ('sub', 2), ('mul', 2), ('div', 2), ('pow', 2), ('rac', 2), ('inv', 1), ('pow2', 1), ('pow3', 1), ('pow4', 1), ('pow5', 1), ('sqrt', 1), ('exp', 1), ('ln', 1), ('abs', 1), ('sign', 1), ('sin', 1), ('cos', 1), ('tan', 1), ('cot', 1), ('sec', 1), ('csc', 1), ('asin', 1), ('acos', 1), ('atan', 1), ('acot', 1), ('asec', 1), ('acsc', 1), ('sinh', 1), ('cosh', 1), ('tanh', 1), ('coth', 1), ('sech', 1), ('csch', 1), ('asinh', 1), ('acosh', 1), ('atanh', 1), ('acoth', 1), ('asech', 1), ('acsch', 1), ('derivative', 2), ('f', 1), ('g', 2)])
INFO - 09/21/20 10:10:24 - 0:00:00 - Unary operators: ['inv', 'pow2', 'pow3', 'pow4', 'pow5', 'sqrt', 'exp', 'ln', 'abs', 'sign', 'sin', 'cos', 'tan', 'cot', 'sec', 'csc', 'asin', 'acos', 'atan', 'acot', 'asec', 'acsc', 'sinh', 'cosh', 'tanh', 'coth', 'sech', 'csch', 'asinh', 'acosh', 'atanh', 'acoth', 'asech', 'acsch', 'f']
INFO - 09/21/20 10:10:24 - 0:00:00 - Binary operators: ['add', 'sub', 'mul', 'div', 'pow', 'rac', 'derivative', 'g']
INFO - 09/21/20 10:10:24 - 0:00:00 - words: {'<s>': 0, '</s>': 1, '<pad>': 2, '(': 3, ')': 4, '<SPECIAL_5>': 5, '<SPECIAL_6>': 6, '<SPECIAL_7>': 7, '<SPECIAL_8>': 8, '<SPECIAL_9>': 9, 'pi': 10, 'E': 11, 'x': 12, 'y': 13, 'z': 14, 't': 15, 'a0': 16, 'a1': 17, 'a2': 18, 'a3': 19, 'a4': 20, 'a5': 21, 'a6': 22, 'a7': 23, 'a8': 24, 'a9': 25, 'abs': 26, 'acos': 27, 'acosh': 28, 'acot': 29, 'acoth': 30, 'acsc': 31, 'acsch': 32, 'add': 33, 'asec': 34, 'asech': 35, 'asin': 36, 'asinh': 37, 'atan': 38, 'atanh': 39, 'cos': 40, 'cosh': 41, 'cot': 42, 'coth': 43, 'csc': 44, 'csch': 45, 'derivative': 46, 'div': 47, 'exp': 48, 'f': 49, 'g': 50, 'inv': 51, 'ln': 52, 'mul': 53, 'pow': 54, 'pow2': 55, 'pow3': 56, 'pow4': 57, 'pow5': 58, 'rac': 59, 'sec': 60, 'sech': 61, 'sign': 62, 'sin': 63, 'sinh': 64, 'sqrt': 65, 'sub': 66, 'tan': 67, 'tanh': 68, 'I': 69, 'INT+': 70, 'INT-': 71, 'INT': 72, 'FLOAT': 73, '-': 74, '.': 75, '10^': 76, 'Y': 77, "Y'": 78, "Y''": 79, '0': 80, '1': 81, '2': 82, '3': 83, '4': 84, '5': 85, '6': 86, '7': 87, '8': 88, '9': 89}
INFO - 09/21/20 10:10:24 - 0:00:00 - 20001 possible leaves.
INFO - 09/21/20 10:10:24 - 0:00:00 - Checking expressions in [0.01, 0.1, 0.3, 0.5, 0.7, 0.9, 1.1, 2.1, 3.1, -0.01, -0.1, -0.3, -0.5, -0.7, -0.9, -1.1, -2.1, -3.1]
INFO - 09/21/20 10:10:24 - 0:00:00 - Training tasks: prim_fwd
INFO - 09/21/20 10:10:24 - 0:00:00 - ============ Initialized logger ============
INFO - 09/21/20 10:10:24 - 0:00:00 - ============ Initialized logger ============
INFO - 09/21/20 10:10:24 - 0:00:00 - accumulate_gradients: 1
                                     amp: -1
                                     attention_dropout: 0
                                     balanced: False
                                     batch_size: 64
                                     beam_early_stopping: True
                                     beam_eval: False
                                     beam_length_penalty: 1
                                     beam_size: 1
                                     character_rnn: True
                                     clean_prefix_expr: True
                                     clip_grad_norm: 5
                                     command: python main.py --local_rank=1 --exp_name treelstm_50k_numenc --emb_dim 128 --n_dec_layers 6 --n_heads 8 --dropout '0.1' --symmetric --treelstm --character_rnn --optimizer 'adam,lr=0.0001' --batch_size 64 --tasks prim_fwd --reload_data 'prim_fwd,fwd_small/fwd_small.train,fwd_small/fwd_small.valid,fwd_small/fwd_small.test' --reload_size 50000 --epoch_size 50000 --max_epoch 50 --exp_id "11626167"
                                     cpu: False
                                     debug: False
                                     debug_slurm: False
                                     dropout: 0.1
                                     dump_path: ./dumped/treelstm_50k_numenc/11626167
                                     emb_dim: 128
                                     env_base_seed: 0
                                     env_name: char_sp
                                     epoch_size: 50000
                                     eval_only: False
                                     eval_verbose: 0
                                     eval_verbose_print: False
                                     exp_id: 11626167
                                     exp_name: treelstm_50k_numenc
                                     export_data: False
                                     fp16: False
                                     global_rank: 1
                                     int_base: 10
                                     is_master: False
                                     is_slurm_job: True
                                     leaf_probs: 0.75,0,0.25,0
                                     local_rank: 1
                                     master_addr: 127.0.0.1
                                     master_port: 29500
                                     max_epoch: 50
                                     max_int: 10000
                                     max_len: 512
                                     max_ops: 10
                                     max_ops_G: 4
                                     multi_gpu: True
                                     multi_node: False
                                     n_coefficients: 0
                                     n_dec_layers: 6
                                     n_enc_layers: 4
                                     n_gpu_per_node: 4
                                     n_heads: 8
                                     n_nodes: 1
                                     n_variables: 1
                                     node_id: 0
                                     num_bit: 10
                                     num_workers: 10
                                     operators: add:2,sub:1
                                     optimizer: adam,lr=0.0001
                                     order: 1
                                     positive: False
                                     precision: 10
                                     reload_checkpoint: 
                                     reload_data: prim_fwd,fwd_small/fwd_small.train,fwd_small/fwd_small.valid,fwd_small/fwd_small.test
                                     reload_model: 
                                     reload_size: 50000
                                     rewrite_functions: 
                                     same_nb_ops_per_batch: False
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     stopping_criterion: 
                                     symmetric: True
                                     tasks: prim_fwd
                                     treelstm: True
                                     treesmu: False
                                     validation_metrics: 
                                     vars: 1
                                     world_size: 4
INFO - 09/21/20 10:10:24 - 0:00:00 - The experiment will be stored in ./dumped/treelstm_50k_numenc/11626167
                                     
INFO - 09/21/20 10:10:24 - 0:00:00 - Running command: python main.py --local_rank=1 --exp_name treelstm_50k_numenc --emb_dim 128 --n_dec_layers 6 --n_heads 8 --dropout '0.1' --symmetric --treelstm --character_rnn --optimizer 'adam,lr=0.0001' --batch_size 64 --tasks prim_fwd --reload_data 'prim_fwd,fwd_small/fwd_small.train,fwd_small/fwd_small.valid,fwd_small/fwd_small.test' --reload_size 50000 --epoch_size 50000 --max_epoch 50

WARNING - 09/21/20 10:10:24 - 0:00:00 - Signal handler installed.
dict_items([('add', 2), ('sub', 2), ('mul', 2), ('div', 2), ('pow', 2), ('rac', 2), ('inv', 1), ('pow2', 1), ('pow3', 1), ('pow4', 1), ('pow5', 1), ('sqrt', 1), ('exp', 1), ('ln', 1), ('abs', 1), ('sign', 1), ('sin', 1), ('cos', 1), ('tan', 1), ('cot', 1), ('sec', 1), ('csc', 1), ('asin', 1), ('acos', 1), ('atan', 1), ('acot', 1), ('asec', 1), ('acsc', 1), ('sinh', 1), ('cosh', 1), ('tanh', 1), ('coth', 1), ('sech', 1), ('csch', 1), ('asinh', 1), ('acosh', 1), ('atanh', 1), ('acoth', 1), ('asech', 1), ('acsch', 1), ('derivative', 2), ('f', 1), ('g', 2)])
INFO - 09/21/20 10:10:24 - 0:00:00 - Unary operators: ['inv', 'pow2', 'pow3', 'pow4', 'pow5', 'sqrt', 'exp', 'ln', 'abs', 'sign', 'sin', 'cos', 'tan', 'cot', 'sec', 'csc', 'asin', 'acos', 'atan', 'acot', 'asec', 'acsc', 'sinh', 'cosh', 'tanh', 'coth', 'sech', 'csch', 'asinh', 'acosh', 'atanh', 'acoth', 'asech', 'acsch', 'f']
INFO - 09/21/20 10:10:24 - 0:00:00 - Binary operators: ['add', 'sub', 'mul', 'div', 'pow', 'rac', 'derivative', 'g']
INFO - 09/21/20 10:10:24 - 0:00:00 - words: {'<s>': 0, '</s>': 1, '<pad>': 2, '(': 3, ')': 4, '<SPECIAL_5>': 5, '<SPECIAL_6>': 6, '<SPECIAL_7>': 7, '<SPECIAL_8>': 8, '<SPECIAL_9>': 9, 'pi': 10, 'E': 11, 'x': 12, 'y': 13, 'z': 14, 't': 15, 'a0': 16, 'a1': 17, 'a2': 18, 'a3': 19, 'a4': 20, 'a5': 21, 'a6': 22, 'a7': 23, 'a8': 24, 'a9': 25, 'abs': 26, 'acos': 27, 'acosh': 28, 'acot': 29, 'acoth': 30, 'acsc': 31, 'acsch': 32, 'add': 33, 'asec': 34, 'asech': 35, 'asin': 36, 'asinh': 37, 'atan': 38, 'atanh': 39, 'cos': 40, 'cosh': 41, 'cot': 42, 'coth': 43, 'csc': 44, 'csch': 45, 'derivative': 46, 'div': 47, 'exp': 48, 'f': 49, 'g': 50, 'inv': 51, 'ln': 52, 'mul': 53, 'pow': 54, 'pow2': 55, 'pow3': 56, 'pow4': 57, 'pow5': 58, 'rac': 59, 'sec': 60, 'sech': 61, 'sign': 62, 'sin': 63, 'sinh': 64, 'sqrt': 65, 'sub': 66, 'tan': 67, 'tanh': 68, 'I': 69, 'INT+': 70, 'INT-': 71, 'INT': 72, 'FLOAT': 73, '-': 74, '.': 75, '10^': 76, 'Y': 77, "Y'": 78, "Y''": 79, '0': 80, '1': 81, '2': 82, '3': 83, '4': 84, '5': 85, '6': 86, '7': 87, '8': 88, '9': 89}
INFO - 09/21/20 10:10:24 - 0:00:00 - 20001 possible leaves.
INFO - 09/21/20 10:10:24 - 0:00:00 - Checking expressions in [0.01, 0.1, 0.3, 0.5, 0.7, 0.9, 1.1, 2.1, 3.1, -0.01, -0.1, -0.3, -0.5, -0.7, -0.9, -1.1, -2.1, -3.1]
INFO - 09/21/20 10:10:24 - 0:00:00 - Training tasks: prim_fwd
INFO - 09/21/20 10:10:24 - 0:00:00 - accumulate_gradients: 1
                                     amp: -1
                                     attention_dropout: 0
                                     balanced: False
                                     batch_size: 64
                                     beam_early_stopping: True
                                     beam_eval: False
                                     beam_length_penalty: 1
                                     beam_size: 1
                                     character_rnn: True
                                     clean_prefix_expr: True
                                     clip_grad_norm: 5
                                     command: python main.py --local_rank=0 --exp_name treelstm_50k_numenc --emb_dim 128 --n_dec_layers 6 --n_heads 8 --dropout '0.1' --symmetric --treelstm --character_rnn --optimizer 'adam,lr=0.0001' --batch_size 64 --tasks prim_fwd --reload_data 'prim_fwd,fwd_small/fwd_small.train,fwd_small/fwd_small.valid,fwd_small/fwd_small.test' --reload_size 50000 --epoch_size 50000 --max_epoch 50 --exp_id "11626167"
                                     cpu: False
                                     debug: False
                                     debug_slurm: False
                                     dropout: 0.1
                                     dump_path: ./dumped/treelstm_50k_numenc/11626167
                                     emb_dim: 128
                                     env_base_seed: 0
                                     env_name: char_sp
                                     epoch_size: 50000
                                     eval_only: False
                                     eval_verbose: 0
                                     eval_verbose_print: False
                                     exp_id: 11626167
                                     exp_name: treelstm_50k_numenc
                                     export_data: False
                                     fp16: False
                                     global_rank: 0
                                     int_base: 10
                                     is_master: True
                                     is_slurm_job: True
                                     leaf_probs: 0.75,0,0.25,0
                                     local_rank: 0
                                     master_addr: 127.0.0.1
                                     master_port: 29500
                                     max_epoch: 50
                                     max_int: 10000
                                     max_len: 512
                                     max_ops: 10
                                     max_ops_G: 4
                                     multi_gpu: True
                                     multi_node: False
                                     n_coefficients: 0
                                     n_dec_layers: 6
                                     n_enc_layers: 4
                                     n_gpu_per_node: 4
                                     n_heads: 8
                                     n_nodes: 1
                                     n_variables: 1
                                     node_id: 0
                                     num_bit: 10
                                     num_workers: 10
                                     operators: add:2,sub:1
                                     optimizer: adam,lr=0.0001
                                     order: 1
                                     positive: False
                                     precision: 10
                                     reload_checkpoint: 
                                     reload_data: prim_fwd,fwd_small/fwd_small.train,fwd_small/fwd_small.valid,fwd_small/fwd_small.test
                                     reload_model: 
                                     reload_size: 50000
                                     rewrite_functions: 
                                     same_nb_ops_per_batch: False
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     stopping_criterion: 
                                     symmetric: True
                                     tasks: prim_fwd
                                     treelstm: True
                                     treesmu: False
                                     validation_metrics: 
                                     vars: 1
                                     world_size: 4
INFO - 09/21/20 10:10:24 - 0:00:00 - The experiment will be stored in ./dumped/treelstm_50k_numenc/11626167
                                     
INFO - 09/21/20 10:10:24 - 0:00:00 - Running command: python main.py --local_rank=0 --exp_name treelstm_50k_numenc --emb_dim 128 --n_dec_layers 6 --n_heads 8 --dropout '0.1' --symmetric --treelstm --character_rnn --optimizer 'adam,lr=0.0001' --batch_size 64 --tasks prim_fwd --reload_data 'prim_fwd,fwd_small/fwd_small.train,fwd_small/fwd_small.valid,fwd_small/fwd_small.test' --reload_size 50000 --epoch_size 50000 --max_epoch 50

WARNING - 09/21/20 10:10:24 - 0:00:00 - Signal handler installed.
dict_items([('add', 2), ('sub', 2), ('mul', 2), ('div', 2), ('pow', 2), ('rac', 2), ('inv', 1), ('pow2', 1), ('pow3', 1), ('pow4', 1), ('pow5', 1), ('sqrt', 1), ('exp', 1), ('ln', 1), ('abs', 1), ('sign', 1), ('sin', 1), ('cos', 1), ('tan', 1), ('cot', 1), ('sec', 1), ('csc', 1), ('asin', 1), ('acos', 1), ('atan', 1), ('acot', 1), ('asec', 1), ('acsc', 1), ('sinh', 1), ('cosh', 1), ('tanh', 1), ('coth', 1), ('sech', 1), ('csch', 1), ('asinh', 1), ('acosh', 1), ('atanh', 1), ('acoth', 1), ('asech', 1), ('acsch', 1), ('derivative', 2), ('f', 1), ('g', 2)])
INFO - 09/21/20 10:10:24 - 0:00:00 - Unary operators: ['inv', 'pow2', 'pow3', 'pow4', 'pow5', 'sqrt', 'exp', 'ln', 'abs', 'sign', 'sin', 'cos', 'tan', 'cot', 'sec', 'csc', 'asin', 'acos', 'atan', 'acot', 'asec', 'acsc', 'sinh', 'cosh', 'tanh', 'coth', 'sech', 'csch', 'asinh', 'acosh', 'atanh', 'acoth', 'asech', 'acsch', 'f']
INFO - 09/21/20 10:10:24 - 0:00:00 - Binary operators: ['add', 'sub', 'mul', 'div', 'pow', 'rac', 'derivative', 'g']
INFO - 09/21/20 10:10:24 - 0:00:00 - words: {'<s>': 0, '</s>': 1, '<pad>': 2, '(': 3, ')': 4, '<SPECIAL_5>': 5, '<SPECIAL_6>': 6, '<SPECIAL_7>': 7, '<SPECIAL_8>': 8, '<SPECIAL_9>': 9, 'pi': 10, 'E': 11, 'x': 12, 'y': 13, 'z': 14, 't': 15, 'a0': 16, 'a1': 17, 'a2': 18, 'a3': 19, 'a4': 20, 'a5': 21, 'a6': 22, 'a7': 23, 'a8': 24, 'a9': 25, 'abs': 26, 'acos': 27, 'acosh': 28, 'acot': 29, 'acoth': 30, 'acsc': 31, 'acsch': 32, 'add': 33, 'asec': 34, 'asech': 35, 'asin': 36, 'asinh': 37, 'atan': 38, 'atanh': 39, 'cos': 40, 'cosh': 41, 'cot': 42, 'coth': 43, 'csc': 44, 'csch': 45, 'derivative': 46, 'div': 47, 'exp': 48, 'f': 49, 'g': 50, 'inv': 51, 'ln': 52, 'mul': 53, 'pow': 54, 'pow2': 55, 'pow3': 56, 'pow4': 57, 'pow5': 58, 'rac': 59, 'sec': 60, 'sech': 61, 'sign': 62, 'sin': 63, 'sinh': 64, 'sqrt': 65, 'sub': 66, 'tan': 67, 'tanh': 68, 'I': 69, 'INT+': 70, 'INT-': 71, 'INT': 72, 'FLOAT': 73, '-': 74, '.': 75, '10^': 76, 'Y': 77, "Y'": 78, "Y''": 79, '0': 80, '1': 81, '2': 82, '3': 83, '4': 84, '5': 85, '6': 86, '7': 87, '8': 88, '9': 89}
INFO - 09/21/20 10:10:24 - 0:00:00 - 20001 possible leaves.
INFO - 09/21/20 10:10:24 - 0:00:00 - Checking expressions in [0.01, 0.1, 0.3, 0.5, 0.7, 0.9, 1.1, 2.1, 3.1, -0.01, -0.1, -0.3, -0.5, -0.7, -0.9, -1.1, -2.1, -3.1]
INFO - 09/21/20 10:10:24 - 0:00:00 - Training tasks: prim_fwd
/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/modules/rnn.py:50: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.1 and num_layers=1
  "num_layers={}".format(dropout, num_layers))
/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/modules/rnn.py:50: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.1 and num_layers=1
  "num_layers={}".format(dropout, num_layers))
/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/modules/rnn.py:50: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.1 and num_layers=1
  "num_layers={}".format(dropout, num_layers))
INFO - 09/21/20 10:10:24 - 0:00:00 - Number of parameters (encoder): 3688832
INFO - 09/21/20 10:10:24 - 0:00:00 - Number of parameters (encoder): 3688832
INFO - 09/21/20 10:10:24 - 0:00:00 - Number of parameters (decoder): 2123610
INFO - 09/21/20 10:10:24 - 0:00:00 - Number of parameters (encoder): 3688832
INFO - 09/21/20 10:10:24 - 0:00:00 - Number of parameters (decoder): 2123610
INFO - 09/21/20 10:10:24 - 0:00:00 - Number of parameters (decoder): 2123610
INFO - 09/21/20 10:10:27 - 0:00:04 - Found 570 parameters in model.
INFO - 09/21/20 10:10:27 - 0:00:04 - Using nn.parallel.DistributedDataParallel ...
INFO - 09/21/20 10:10:30 - 0:00:06 - Found 570 parameters in model.
INFO - 09/21/20 10:10:30 - 0:00:06 - Using nn.parallel.DistributedDataParallel ...
INFO - 09/21/20 10:10:30 - 0:00:06 - Found 570 parameters in model.
INFO - 09/21/20 10:10:30 - 0:00:06 - Using nn.parallel.DistributedDataParallel ...
INFO - 09/21/20 10:10:30 - 0:00:07 - Found 570 parameters in model.
INFO - 09/21/20 10:10:30 - 0:00:07 - Using nn.parallel.DistributedDataParallel ...
INFO - 09/21/20 10:10:31 - 0:00:07 - Optimizers: model
INFO - 09/21/20 10:10:31 - 0:00:07 - Optimizers: model
INFO - 09/21/20 10:10:31 - 0:00:07 - Optimizers: model
INFO - 09/21/20 10:10:31 - 0:00:07 - Creating train iterator for prim_fwd ...
INFO - 09/21/20 10:10:31 - 0:00:07 - Creating train iterator for prim_fwd ...
INFO - 09/21/20 10:10:31 - 0:00:07 - Creating train iterator for prim_fwd ...
['abs', 'acos', 'acosh', 'acot', 'acoth', 'acsc', 'acsch', 'add', 'asec', 'asech', 'asin', 'asinh', 'atan', 'atanh', 'cos', 'cosh', 'cot', 'coth', 'csc', 'csch', 'derivative', 'div', 'exp', 'f', 'g', 'inv', 'ln', 'mul', 'pow', 'pow2', 'pow3', 'pow4', 'pow5', 'rac', 'sec', 'sech', 'sign', 'sin', 'sinh', 'sqrt', 'sub', 'tan', 'tanh']
['abs', 'acos', 'acosh', 'acot', 'acoth', 'acsc', 'acsch', 'add', 'asec', 'asech', 'asin', 'asinh', 'atan', 'atanh', 'cos', 'cosh', 'cot', 'coth', 'csc', 'csch', 'derivative', 'div', 'exp', 'f', 'g', 'inv', 'ln', 'mul', 'pow', 'pow2', 'pow3', 'pow4', 'pow5', 'rac', 'sec', 'sech', 'sign', 'sin', 'sinh', 'sqrt', 'sub', 'tan', 'tanh']
['abs', 'acos', 'acosh', 'acot', 'acoth', 'acsc', 'acsch', 'add', 'asec', 'asech', 'asin', 'asinh', 'atan', 'atanh', 'cos', 'cosh', 'cot', 'coth', 'csc', 'csch', 'derivative', 'div', 'exp', 'f', 'g', 'inv', 'ln', 'mul', 'pow', 'pow2', 'pow3', 'pow4', 'pow5', 'rac', 'sec', 'sech', 'sign', 'sin', 'sinh', 'sqrt', 'sub', 'tan', 'tanh']
INFO - 09/21/20 10:10:31 - 0:00:07 - Loading data from fwd_small/fwd_small.train ...
INFO - 09/21/20 10:10:31 - 0:00:07 - Loading data from fwd_small/fwd_small.train ...
INFO - 09/21/20 10:10:31 - 0:00:07 - Loading data from fwd_small/fwd_small.train ...
INFO - 09/21/20 10:10:31 - 0:00:07 - Loaded 12500 equations from the disk.
INFO - 09/21/20 10:10:31 - 0:00:07 - Loaded 12500 equations from the disk.
INFO - 09/21/20 10:10:31 - 0:00:07 - Loaded 12500 equations from the disk.
INFO - 09/21/20 10:10:31 - 0:00:08 - Optimizers: model
INFO - 09/21/20 10:10:31 - 0:00:08 - Creating train iterator for prim_fwd ...
['abs', 'acos', 'acosh', 'acot', 'acoth', 'acsc', 'acsch', 'add', 'asec', 'asech', 'asin', 'asinh', 'atan', 'atanh', 'cos', 'cosh', 'cot', 'coth', 'csc', 'csch', 'derivative', 'div', 'exp', 'f', 'g', 'inv', 'ln', 'mul', 'pow', 'pow2', 'pow3', 'pow4', 'pow5', 'rac', 'sec', 'sech', 'sign', 'sin', 'sinh', 'sqrt', 'sub', 'tan', 'tanh']
INFO - 09/21/20 10:10:31 - 0:00:08 - Loading data from fwd_small/fwd_small.train ...
INFO - 09/21/20 10:10:31 - 0:00:09 - Loaded 12500 equations from the disk.
INFO - 09/21/20 10:10:31 - 0:00:08 - ============ Starting epoch 0 ... ============
INFO - 09/21/20 10:10:31 - 0:00:08 - ============ Starting epoch 0 ... ============
INFO - 09/21/20 10:10:31 - 0:00:08 - ============ Starting epoch 0 ... ============
INFO - 09/21/20 10:10:31 - 0:00:08 - Initialized random generator for worker 0, with seed [0, 0, 0] (base seed=0).
INFO - 09/21/20 10:10:31 - 0:00:08 - Initialized random generator for worker 0, with seed [0, 1, 0] (base seed=0).
INFO - 09/21/20 10:10:31 - 0:00:08 - Initialized random generator for worker 0, with seed [0, 3, 0] (base seed=0).
INFO - 09/21/20 10:10:31 - 0:00:09 - ============ Starting epoch 0 ... ============
INFO - 09/21/20 10:10:31 - 0:00:09 - Initialized random generator for worker 0, with seed [0, 2, 0] (base seed=0).
/opt/conda/conda-bld/pytorch_1587428266983/work/torch/csrc/utils/python_arg_parser.cpp:756: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha)
/opt/conda/conda-bld/pytorch_1587428266983/work/torch/csrc/utils/python_arg_parser.cpp:756: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha)
/opt/conda/conda-bld/pytorch_1587428266983/work/torch/csrc/utils/python_arg_parser.cpp:756: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha)
/opt/conda/conda-bld/pytorch_1587428266983/work/torch/csrc/utils/python_arg_parser.cpp:756: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha)
INFO - 09/21/20 10:11:10 - 0:00:46 -      20 -   32.60 equations/s -  1283.55 words/s - PRIM-FWD:  3.9476 - model LR: 1.0000e-04
INFO - 09/21/20 10:11:10 - 0:00:46 -      20 -   32.60 equations/s -  1305.92 words/s - PRIM-FWD:  3.9626 - model LR: 1.0000e-04
INFO - 09/21/20 10:11:10 - 0:00:47 -      20 -   32.53 equations/s -  1292.27 words/s - PRIM-FWD:  3.9613 - model LR: 1.0000e-04
INFO - 09/21/20 10:11:10 - 0:00:48 -      20 -   32.71 equations/s -  1323.57 words/s - PRIM-FWD:  3.9598 - model LR: 1.0000e-04
INFO - 09/21/20 10:11:48 - 0:01:24 -      40 -   33.97 equations/s -  1310.47 words/s - PRIM-FWD:  2.7611 - model LR: 1.0000e-04
INFO - 09/21/20 10:11:48 - 0:01:24 -      40 -   33.89 equations/s -  1352.52 words/s - PRIM-FWD:  2.7892 - model LR: 1.0000e-04
INFO - 09/21/20 10:11:48 - 0:01:25 -      40 -   33.97 equations/s -  1379.55 words/s - PRIM-FWD:  2.7791 - model LR: 1.0000e-04
INFO - 09/21/20 10:11:48 - 0:01:24 -      40 -   33.88 equations/s -  1348.31 words/s - PRIM-FWD:  2.7757 - model LR: 1.0000e-04
INFO - 09/21/20 10:12:25 - 0:02:01 -      60 -   34.57 equations/s -  1375.60 words/s - PRIM-FWD:  2.4091 - model LR: 1.0000e-04
INFO - 09/21/20 10:12:25 - 0:02:01 -      60 -   34.56 equations/s -  1367.90 words/s - PRIM-FWD:  2.4066 - model LR: 1.0000e-04
INFO - 09/21/20 10:12:25 - 0:02:02 -      60 -   34.56 equations/s -  1345.18 words/s - PRIM-FWD:  2.3920 - model LR: 1.0000e-04
INFO - 09/21/20 10:12:25 - 0:02:01 -      60 -   34.57 equations/s -  1369.73 words/s - PRIM-FWD:  2.4084 - model LR: 1.0000e-04
INFO - 09/21/20 10:13:02 - 0:02:38 -      80 -   34.49 equations/s -  1363.95 words/s - PRIM-FWD:  1.9932 - model LR: 1.0000e-04
INFO - 09/21/20 10:13:02 - 0:02:39 -      80 -   34.49 equations/s -  1333.88 words/s - PRIM-FWD:  1.9832 - model LR: 1.0000e-04
INFO - 09/21/20 10:13:02 - 0:02:38 -      80 -   34.47 equations/s -  1349.42 words/s - PRIM-FWD:  2.0016 - model LR: 1.0000e-04
INFO - 09/21/20 10:13:02 - 0:02:38 -      80 -   34.41 equations/s -  1386.16 words/s - PRIM-FWD:  2.0144 - model LR: 1.0000e-04
INFO - 09/21/20 10:13:39 - 0:03:16 -     100 -   34.24 equations/s -  1333.19 words/s - PRIM-FWD:  1.7591 - model LR: 1.0000e-04
INFO - 09/21/20 10:13:39 - 0:03:16 -     100 -   34.24 equations/s -  1338.60 words/s - PRIM-FWD:  1.7786 - model LR: 1.0000e-04
INFO - 09/21/20 10:13:39 - 0:03:17 -     100 -   34.24 equations/s -  1372.46 words/s - PRIM-FWD:  1.7787 - model LR: 1.0000e-04
INFO - 09/21/20 10:13:39 - 0:03:16 -     100 -   34.31 equations/s -  1386.04 words/s - PRIM-FWD:  1.7813 - model LR: 1.0000e-04
INFO - 09/21/20 10:14:16 - 0:03:53 -     120 -   34.63 equations/s -  1387.10 words/s - PRIM-FWD:  1.6609 - model LR: 1.0000e-04
INFO - 09/21/20 10:14:16 - 0:03:53 -     120 -   34.63 equations/s -  1404.95 words/s - PRIM-FWD:  1.7173 - model LR: 1.0000e-04
INFO - 09/21/20 10:14:16 - 0:03:54 -     120 -   34.63 equations/s -  1392.26 words/s - PRIM-FWD:  1.6815 - model LR: 1.0000e-04
INFO - 09/21/20 10:14:16 - 0:03:53 -     120 -   34.63 equations/s -  1338.45 words/s - PRIM-FWD:  1.6646 - model LR: 1.0000e-04
INFO - 09/21/20 10:14:54 - 0:04:30 -     140 -   33.90 equations/s -  1339.90 words/s - PRIM-FWD:  1.6288 - model LR: 1.0000e-04
INFO - 09/21/20 10:14:54 - 0:04:31 -     140 -   33.89 equations/s -  1343.35 words/s - PRIM-FWD:  1.6380 - model LR: 1.0000e-04
INFO - 09/21/20 10:14:54 - 0:04:31 -     140 -   33.89 equations/s -  1341.01 words/s - PRIM-FWD:  1.6271 - model LR: 1.0000e-04
INFO - 09/21/20 10:14:54 - 0:04:31 -     140 -   33.89 equations/s -  1366.93 words/s - PRIM-FWD:  1.6402 - model LR: 1.0000e-04
INFO - 09/21/20 10:15:31 - 0:05:08 -     160 -   34.38 equations/s -  1352.99 words/s - PRIM-FWD:  1.5651 - model LR: 1.0000e-04
INFO - 09/21/20 10:15:31 - 0:05:09 -     160 -   34.37 equations/s -  1353.39 words/s - PRIM-FWD:  1.5909 - model LR: 1.0000e-04
INFO - 09/21/20 10:15:31 - 0:05:08 -     160 -   34.36 equations/s -  1350.19 words/s - PRIM-FWD:  1.5734 - model LR: 1.0000e-04
INFO - 09/21/20 10:15:31 - 0:05:08 -     160 -   34.34 equations/s -  1331.55 words/s - PRIM-FWD:  1.5844 - model LR: 1.0000e-04
INFO - 09/21/20 10:16:08 - 0:05:45 -     180 -   34.54 equations/s -  1378.53 words/s - PRIM-FWD:  1.5914 - model LR: 1.0000e-04
INFO - 09/21/20 10:16:08 - 0:05:46 -     180 -   34.53 equations/s -  1373.23 words/s - PRIM-FWD:  1.5408 - model LR: 1.0000e-04
INFO - 09/21/20 10:16:08 - 0:05:45 -     180 -   34.50 equations/s -  1346.68 words/s - PRIM-FWD:  1.5344 - model LR: 1.0000e-04
INFO - 09/21/20 10:16:08 - 0:05:45 -     180 -   34.56 equations/s -  1389.95 words/s - PRIM-FWD:  1.5441 - model LR: 1.0000e-04
INFO - 09/21/20 10:16:47 - 0:06:23 -     200 -   33.62 equations/s -  1302.51 words/s - PRIM-FWD:  1.5072 - model LR: 1.0000e-04
INFO - 09/21/20 10:16:47 - 0:06:23 -     200 -   33.61 equations/s -  1326.75 words/s - PRIM-FWD:  1.5138 - model LR: 1.0000e-04
INFO - 09/21/20 10:16:47 - 0:06:23 -     200 -   33.61 equations/s -  1348.20 words/s - PRIM-FWD:  1.5096 - model LR: 1.0000e-04
INFO - 09/21/20 10:16:47 - 0:06:24 -     200 -   33.60 equations/s -  1334.91 words/s - PRIM-FWD:  1.5065 - model LR: 1.0000e-04
INFO - 09/21/20 10:17:24 - 0:07:00 -     220 -   34.27 equations/s -  1377.78 words/s - PRIM-FWD:  1.4813 - model LR: 1.0000e-04
INFO - 09/21/20 10:17:24 - 0:07:00 -     220 -   34.25 equations/s -  1350.07 words/s - PRIM-FWD:  1.4523 - model LR: 1.0000e-04
INFO - 09/21/20 10:17:24 - 0:07:01 -     220 -   34.27 equations/s -  1366.28 words/s - PRIM-FWD:  1.4677 - model LR: 1.0000e-04
INFO - 09/21/20 10:17:24 - 0:07:00 -     220 -   34.26 equations/s -  1358.59 words/s - PRIM-FWD:  1.4717 - model LR: 1.0000e-04
INFO - 09/21/20 10:18:02 - 0:07:39 -     240 -   33.32 equations/s -  1333.43 words/s - PRIM-FWD:  1.4443 - model LR: 1.0000e-04
INFO - 09/21/20 10:18:02 - 0:07:40 -     240 -   33.32 equations/s -  1330.90 words/s - PRIM-FWD:  1.4035 - model LR: 1.0000e-04
INFO - 09/21/20 10:18:02 - 0:07:39 -     240 -   33.30 equations/s -  1328.68 words/s - PRIM-FWD:  1.4272 - model LR: 1.0000e-04
INFO - 09/21/20 10:18:02 - 0:07:39 -     240 -   33.31 equations/s -  1356.49 words/s - PRIM-FWD:  1.4626 - model LR: 1.0000e-04
INFO - 09/21/20 10:18:39 - 0:08:15 -     260 -   34.78 equations/s -  1412.88 words/s - PRIM-FWD:  1.3902 - model LR: 1.0000e-04
INFO - 09/21/20 10:18:39 - 0:08:15 -     260 -   34.79 equations/s -  1407.02 words/s - PRIM-FWD:  1.4090 - model LR: 1.0000e-04
INFO - 09/21/20 10:18:39 - 0:08:15 -     260 -   34.78 equations/s -  1407.83 words/s - PRIM-FWD:  1.4106 - model LR: 1.0000e-04
INFO - 09/21/20 10:18:39 - 0:08:16 -     260 -   34.77 equations/s -  1386.82 words/s - PRIM-FWD:  1.3807 - model LR: 1.0000e-04
INFO - 09/21/20 10:19:17 - 0:08:53 -     280 -   34.10 equations/s -  1360.14 words/s - PRIM-FWD:  1.4050 - model LR: 1.0000e-04
INFO - 09/21/20 10:19:17 - 0:08:53 -     280 -   34.09 equations/s -  1376.89 words/s - PRIM-FWD:  1.3641 - model LR: 1.0000e-04
INFO - 09/21/20 10:19:17 - 0:08:54 -     280 -   34.10 equations/s -  1348.08 words/s - PRIM-FWD:  1.3700 - model LR: 1.0000e-04
INFO - 09/21/20 10:19:17 - 0:08:53 -     280 -   34.03 equations/s -  1348.19 words/s - PRIM-FWD:  1.3858 - model LR: 1.0000e-04
INFO - 09/21/20 10:19:54 - 0:09:31 -     300 -   33.86 equations/s -  1318.85 words/s - PRIM-FWD:  1.3211 - model LR: 1.0000e-04
INFO - 09/21/20 10:19:54 - 0:09:32 -     300 -   33.87 equations/s -  1351.65 words/s - PRIM-FWD:  1.3620 - model LR: 1.0000e-04
INFO - 09/21/20 10:19:54 - 0:09:31 -     300 -   33.93 equations/s -  1342.23 words/s - PRIM-FWD:  1.3309 - model LR: 1.0000e-04
INFO - 09/21/20 10:19:54 - 0:09:31 -     300 -   33.88 equations/s -  1325.88 words/s - PRIM-FWD:  1.3063 - model LR: 1.0000e-04
INFO - 09/21/20 10:20:32 - 0:10:08 -     320 -   34.47 equations/s -  1370.17 words/s - PRIM-FWD:  1.2925 - model LR: 1.0000e-04
INFO - 09/21/20 10:20:32 - 0:10:08 -     320 -   34.47 equations/s -  1317.83 words/s - PRIM-FWD:  1.3162 - model LR: 1.0000e-04
INFO - 09/21/20 10:20:32 - 0:10:08 -     320 -   34.48 equations/s -  1380.43 words/s - PRIM-FWD:  1.3028 - model LR: 1.0000e-04
INFO - 09/21/20 10:20:32 - 0:10:09 -     320 -   34.47 equations/s -  1368.77 words/s - PRIM-FWD:  1.3253 - model LR: 1.0000e-04
INFO - 09/21/20 10:21:09 - 0:10:45 -     340 -   34.50 equations/s -  1362.88 words/s - PRIM-FWD:  1.2587 - model LR: 1.0000e-04
INFO - 09/21/20 10:21:09 - 0:10:45 -     340 -   34.50 equations/s -  1339.53 words/s - PRIM-FWD:  1.2690 - model LR: 1.0000e-04
INFO - 09/21/20 10:21:09 - 0:10:46 -     340 -   34.50 equations/s -  1331.31 words/s - PRIM-FWD:  1.2513 - model LR: 1.0000e-04
INFO - 09/21/20 10:21:09 - 0:10:45 -     340 -   34.49 equations/s -  1393.76 words/s - PRIM-FWD:  1.2978 - model LR: 1.0000e-04
INFO - 09/21/20 10:21:46 - 0:11:22 -     360 -   34.50 equations/s -  1364.31 words/s - PRIM-FWD:  1.2932 - model LR: 1.0000e-04
INFO - 09/21/20 10:21:46 - 0:11:22 -     360 -   34.50 equations/s -  1359.50 words/s - PRIM-FWD:  1.2602 - model LR: 1.0000e-04
INFO - 09/21/20 10:21:46 - 0:11:23 -     360 -   34.50 equations/s -  1367.24 words/s - PRIM-FWD:  1.2439 - model LR: 1.0000e-04
INFO - 09/21/20 10:21:46 - 0:11:22 -     360 -   34.50 equations/s -  1390.67 words/s - PRIM-FWD:  1.2604 - model LR: 1.0000e-04
INFO - 09/21/20 10:22:23 - 0:12:00 -     380 -   34.13 equations/s -  1327.39 words/s - PRIM-FWD:  1.2102 - model LR: 1.0000e-04
INFO - 09/21/20 10:22:23 - 0:12:00 -     380 -   34.14 equations/s -  1370.81 words/s - PRIM-FWD:  1.2227 - model LR: 1.0000e-04
INFO - 09/21/20 10:22:23 - 0:12:01 -     380 -   34.14 equations/s -  1368.48 words/s - PRIM-FWD:  1.2561 - model LR: 1.0000e-04
INFO - 09/21/20 10:22:23 - 0:12:00 -     380 -   34.14 equations/s -  1367.73 words/s - PRIM-FWD:  1.2385 - model LR: 1.0000e-04
INFO - 09/21/20 10:23:00 - 0:12:37 -     400 -   34.46 equations/s -  1371.50 words/s - PRIM-FWD:  1.2271 - model LR: 1.0000e-04
INFO - 09/21/20 10:23:00 - 0:12:37 -     400 -   34.44 equations/s -  1388.19 words/s - PRIM-FWD:  1.2330 - model LR: 1.0000e-04
INFO - 09/21/20 10:23:00 - 0:12:38 -     400 -   34.45 equations/s -  1365.16 words/s - PRIM-FWD:  1.2208 - model LR: 1.0000e-04
INFO - 09/21/20 10:23:00 - 0:12:37 -     400 -   34.44 equations/s -  1396.32 words/s - PRIM-FWD:  1.2199 - model LR: 1.0000e-04
INFO - 09/21/20 10:23:38 - 0:13:15 -     420 -   33.88 equations/s -  1383.52 words/s - PRIM-FWD:  1.2294 - model LR: 1.0000e-04
INFO - 09/21/20 10:23:38 - 0:13:16 -     420 -   33.90 equations/s -  1338.31 words/s - PRIM-FWD:  1.1951 - model LR: 1.0000e-04
INFO - 09/21/20 10:23:38 - 0:13:15 -     420 -   33.91 equations/s -  1356.75 words/s - PRIM-FWD:  1.1960 - model LR: 1.0000e-04
INFO - 09/21/20 10:23:38 - 0:13:15 -     420 -   33.90 equations/s -  1339.37 words/s - PRIM-FWD:  1.1993 - model LR: 1.0000e-04
INFO - 09/21/20 10:24:15 - 0:13:52 -     440 -   34.57 equations/s -  1362.11 words/s - PRIM-FWD:  1.1793 - model LR: 1.0000e-04
INFO - 09/21/20 10:24:15 - 0:13:52 -     440 -   34.55 equations/s -  1360.60 words/s - PRIM-FWD:  1.1616 - model LR: 1.0000e-04
INFO - 09/21/20 10:24:15 - 0:13:53 -     440 -   34.55 equations/s -  1340.27 words/s - PRIM-FWD:  1.1804 - model LR: 1.0000e-04
INFO - 09/21/20 10:24:15 - 0:13:52 -     440 -   34.55 equations/s -  1376.49 words/s - PRIM-FWD:  1.1881 - model LR: 1.0000e-04
INFO - 09/21/20 10:24:53 - 0:14:29 -     460 -   34.09 equations/s -  1340.04 words/s - PRIM-FWD:  1.1374 - model LR: 1.0000e-04
INFO - 09/21/20 10:24:53 - 0:14:29 -     460 -   34.10 equations/s -  1347.50 words/s - PRIM-FWD:  1.1580 - model LR: 1.0000e-04
INFO - 09/21/20 10:24:53 - 0:14:30 -     460 -   34.10 equations/s -  1360.94 words/s - PRIM-FWD:  1.1546 - model LR: 1.0000e-04
INFO - 09/21/20 10:24:53 - 0:14:29 -     460 -   34.12 equations/s -  1328.39 words/s - PRIM-FWD:  1.1359 - model LR: 1.0000e-04
INFO - 09/21/20 10:25:30 - 0:15:06 -     480 -   34.38 equations/s -  1344.72 words/s - PRIM-FWD:  1.1293 - model LR: 1.0000e-04
INFO - 09/21/20 10:25:30 - 0:15:07 -     480 -   34.38 equations/s -  1355.57 words/s - PRIM-FWD:  1.1144 - model LR: 1.0000e-04
INFO - 09/21/20 10:25:30 - 0:15:06 -     480 -   34.37 equations/s -  1389.75 words/s - PRIM-FWD:  1.1614 - model LR: 1.0000e-04
INFO - 09/21/20 10:25:30 - 0:15:06 -     480 -   34.35 equations/s -  1376.05 words/s - PRIM-FWD:  1.1498 - model LR: 1.0000e-04
INFO - 09/21/20 10:26:07 - 0:15:44 -     500 -   34.39 equations/s -  1357.44 words/s - PRIM-FWD:  1.1072 - model LR: 1.0000e-04
INFO - 09/21/20 10:26:07 - 0:15:45 -     500 -   34.39 equations/s -  1371.21 words/s - PRIM-FWD:  1.1053 - model LR: 1.0000e-04
INFO - 09/21/20 10:26:07 - 0:15:44 -     500 -   34.39 equations/s -  1348.31 words/s - PRIM-FWD:  1.0881 - model LR: 1.0000e-04
INFO - 09/21/20 10:26:07 - 0:15:44 -     500 -   34.41 equations/s -  1371.04 words/s - PRIM-FWD:  1.1126 - model LR: 1.0000e-04
INFO - 09/21/20 10:26:45 - 0:16:21 -     520 -   33.98 equations/s -  1339.45 words/s - PRIM-FWD:  1.1000 - model LR: 1.0000e-04
INFO - 09/21/20 10:26:45 - 0:16:22 -     520 -   33.98 equations/s -  1379.65 words/s - PRIM-FWD:  1.0979 - model LR: 1.0000e-04
INFO - 09/21/20 10:26:45 - 0:16:21 -     520 -   33.98 equations/s -  1367.18 words/s - PRIM-FWD:  1.1345 - model LR: 1.0000e-04
INFO - 09/21/20 10:26:45 - 0:16:21 -     520 -   33.97 equations/s -  1323.98 words/s - PRIM-FWD:  1.0812 - model LR: 1.0000e-04
Traceback (most recent call last):
  File "main.py", line 246, in <module>
    main(params)
  File "main.py", line 209, in main
    trainer.enc_dec_step(task)
  File "/central/home/aypan/enc_dec/src/trainer.py", line 515, in enc_dec_step
    encoded = encoder(x=tensors, lengths=len1, seq_num=params.character_rnn)
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/parallel/distributed.py", line 445, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    result = self.forward(*input, **kwargs)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 766, in forward
    return self.forward_(x, lengths, seq_num)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 842, in forward_
    assert len(hidden) == num_nodes + sum(int_lens).item() - len(int_lens)	
AssertionError
Traceback (most recent call last):
  File "/home/aypan/miniconda3/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/aypan/miniconda3/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/distributed/launch.py", line 263, in <module>
    main()
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/distributed/launch.py", line 259, in main
    cmd=cmd)
subprocess.CalledProcessError: Command '['/home/aypan/miniconda3/bin/python3', '-u', 'main.py', '--local_rank=3', '--exp_name', 'treelstm_50k_numenc', '--emb_dim', '128', '--n_dec_layers', '6', '--n_heads', '8', '--dropout', '0.1', '--symmetric', '--treelstm', '--character_rnn', '--optimizer', 'adam,lr=0.0001', '--batch_size', '64', '--tasks', 'prim_fwd', '--reload_data', 'prim_fwd,fwd_small/fwd_small.train,fwd_small/fwd_small.valid,fwd_small/fwd_small.test', '--reload_size', '50000', '--epoch_size', '50000', '--max_epoch', '50']' returned non-zero exit status 1.
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
done
