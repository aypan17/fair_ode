INFO - 09/13/20 15:38:07 - 0:00:00 - ============ Initialized logger ============
INFO - 09/13/20 15:38:07 - 0:00:00 - accumulate_gradients: 1
                                     amp: -1
                                     attention_dropout: 0
                                     balanced: False
                                     batch_size: 32
                                     beam_early_stopping: True
                                     beam_eval: False
                                     beam_length_penalty: 1
                                     beam_size: 1
                                     clean_prefix_expr: True
                                     clip_grad_norm: 5
                                     command: python main.py --export_data true --batch_size 32 --cpu true --exp_name fwd_data_gen --num_workers 28 --tasks prim_fwd --env_base_seed '-1' --n_variables 1 --n_coefficients 0 --leaf_probs '0.75,0,0.25,0' --max_ops 20 --max_int 5 --max_len 512 --master_port 12001 --operators 'add:10,sub:3,mul:10,div:5,sqrt:4,pow2:4,pow3:2,pow4:1,pow5:1,ln:4,exp:4,sin:4,cos:4,tan:4,asin:1,acos:1,atan:1,sinh:1,cosh:1,tanh:1,asinh:1,acosh:1,atanh:1' --exp_id "11241569"
                                     cpu: True
                                     debug: False
                                     debug_slurm: False
                                     dropout: 0
                                     dump_path: ./dumped/fwd_data_gen/11241569
                                     emb_dim: 256
                                     env_base_seed: -1
                                     env_name: char_sp
                                     epoch_size: 300000
                                     eval_only: False
                                     eval_verbose: 0
                                     eval_verbose_print: False
                                     exp_id: 11241569
                                     exp_name: fwd_data_gen
                                     export_data: True
                                     fp16: False
                                     global_rank: 0
                                     int_base: 10
                                     is_master: True
                                     is_slurm_job: True
                                     leaf_probs: 0.75,0,0.25,0
                                     local_rank: 0
                                     master_addr: hpc-25-17
                                     master_port: 12001
                                     max_epoch: 100000
                                     max_int: 5
                                     max_len: 512
                                     max_ops: 20
                                     max_ops_G: 4
                                     multi_gpu: True
                                     multi_node: False
                                     n_coefficients: 0
                                     n_dec_layers: 4
                                     n_enc_layers: 4
                                     n_gpu_per_node: 28
                                     n_heads: 4
                                     n_nodes: 1
                                     n_variables: 1
                                     node_id: 0
                                     num_bit: 10
                                     num_workers: 28
                                     operators: add:10,sub:3,mul:10,div:5,sqrt:4,pow2:4,pow3:2,pow4:1,pow5:1,ln:4,exp:4,sin:4,cos:4,tan:4,asin:1,acos:1,atan:1,sinh:1,cosh:1,tanh:1,asinh:1,acosh:1,atanh:1
                                     optimizer: adam,lr=0.0001
                                     order: 1
                                     positive: False
                                     precision: 10
                                     reload_checkpoint: 
                                     reload_data: 
                                     reload_model: 
                                     reload_size: -1
                                     rewrite_functions: 
                                     same_nb_ops_per_batch: False
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     stopping_criterion: 
                                     symmetric: False
                                     tasks: prim_fwd
                                     treelstm: False
                                     validation_metrics: 
                                     vars: 1
                                     world_size: 28
INFO - 09/13/20 15:38:07 - 0:00:00 - The experiment will be stored in ./dumped/fwd_data_gen/11241569
                                     
INFO - 09/13/20 15:38:07 - 0:00:00 - Running command: python main.py --export_data true --batch_size 32 --cpu true --exp_name fwd_data_gen --num_workers 28 --tasks prim_fwd --env_base_seed '-1' --n_variables 1 --n_coefficients 0 --leaf_probs '0.75,0,0.25,0' --max_ops 20 --max_int 5 --max_len 512 --master_port 12001 --operators 'add:10,sub:3,mul:10,div:5,sqrt:4,pow2:4,pow3:2,pow4:1,pow5:1,ln:4,exp:4,sin:4,cos:4,tan:4,asin:1,acos:1,atan:1,sinh:1,cosh:1,tanh:1,asinh:1,acosh:1,atanh:1'

WARNING - 09/13/20 15:38:07 - 0:00:00 - Signal handler installed.
0 - SLURM_JOB_ID: 11241569
0 - SLURM_JOB_NODELIST: hpc-25-17
0 - SLURM_JOB_NUM_NODES: 1
0 - SLURM_NTASKS: 28
0 - SLURM_TASKS_PER_NODE: 28
0 - SLURM_MEM_PER_NODE: None
0 - SLURM_MEM_PER_CPU: 4096
0 - SLURM_NODEID: 0
0 - SLURM_PROCID: 0
0 - SLURM_LOCALID: 0
0 - SLURM_TASK_PID: 19852
environ({'SLURM_NODELIST': 'hpc-25-17', 'SLURM_JOB_NAME': 'fwd_data_gen', 'XDG_SESSION_ID': 'c2', 'HOSTNAME': 'hpc-25-17', 'SLURMD_NODENAME': 'hpc-25-17', 'SLURM_TOPOLOGY_ADDR': 'hpc-25-17', 'SLURM_PRIO_PROCESS': '0', 'SLURM_NODE_ALIASES': '(null)', 'SLURM_EXPORT_ENV': 'NONE', 'TERM': 'screen-256color', 'VTE_VERSION': '5202', 'host': 'hpc-25-17.cm.cluster', 'SHELL': '/bin/bash', 'SLURM_JOB_QOS': 'normal', 'HISTSIZE': '1000', 'SLURM_TOPOLOGY_ADDR_PATTERN': 'node', 'TMPDIR': '/tmp', 'CONDA_SHLVL': '1', 'CONDA_PROMPT_MODIFIER': '(base) ', 'WINDOWID': '37748739', 'QTDIR': '/usr/lib64/qt-3.3', 'QTINC': '/usr/lib64/qt-3.3/include', 'SLURM_MEM_PER_CPU': '4096', 'QT_GRAPHICSSYSTEM_CHECKED': '1', 'SLURM_NNODES': '1', 'USER': 'aypan', 'LS_COLORS': 'rs=0:di=38;5;27:ln=38;5;51:mh=44;38;5;15:pi=40;38;5;11:so=38;5;13:do=38;5;5:bd=48;5;232;38;5;11:cd=48;5;232;38;5;3:or=48;5;232;38;5;9:mi=05;48;5;232;38;5;15:su=48;5;196;38;5;15:sg=48;5;11;38;5;16:ca=48;5;196;38;5;226:tw=48;5;10;38;5;16:ow=48;5;10;38;5;21:st=48;5;21;38;5;15:ex=38;5;34:*.tar=38;5;9:*.tgz=38;5;9:*.arc=38;5;9:*.arj=38;5;9:*.taz=38;5;9:*.lha=38;5;9:*.lz4=38;5;9:*.lzh=38;5;9:*.lzma=38;5;9:*.tlz=38;5;9:*.txz=38;5;9:*.tzo=38;5;9:*.t7z=38;5;9:*.zip=38;5;9:*.z=38;5;9:*.Z=38;5;9:*.dz=38;5;9:*.gz=38;5;9:*.lrz=38;5;9:*.lz=38;5;9:*.lzo=38;5;9:*.xz=38;5;9:*.bz2=38;5;9:*.bz=38;5;9:*.tbz=38;5;9:*.tbz2=38;5;9:*.tz=38;5;9:*.deb=38;5;9:*.rpm=38;5;9:*.jar=38;5;9:*.war=38;5;9:*.ear=38;5;9:*.sar=38;5;9:*.rar=38;5;9:*.alz=38;5;9:*.ace=38;5;9:*.zoo=38;5;9:*.cpio=38;5;9:*.7z=38;5;9:*.rz=38;5;9:*.cab=38;5;9:*.jpg=38;5;13:*.jpeg=38;5;13:*.gif=38;5;13:*.bmp=38;5;13:*.pbm=38;5;13:*.pgm=38;5;13:*.ppm=38;5;13:*.tga=38;5;13:*.xbm=38;5;13:*.xpm=38;5;13:*.tif=38;5;13:*.tiff=38;5;13:*.png=38;5;13:*.svg=38;5;13:*.svgz=38;5;13:*.mng=38;5;13:*.pcx=38;5;13:*.mov=38;5;13:*.mpg=38;5;13:*.mpeg=38;5;13:*.m2v=38;5;13:*.mkv=38;5;13:*.webm=38;5;13:*.ogm=38;5;13:*.mp4=38;5;13:*.m4v=38;5;13:*.mp4v=38;5;13:*.vob=38;5;13:*.qt=38;5;13:*.nuv=38;5;13:*.wmv=38;5;13:*.asf=38;5;13:*.rm=38;5;13:*.rmvb=38;5;13:*.flc=38;5;13:*.avi=38;5;13:*.fli=38;5;13:*.flv=38;5;13:*.gl=38;5;13:*.dl=38;5;13:*.xcf=38;5;13:*.xwd=38;5;13:*.yuv=38;5;13:*.cgm=38;5;13:*.emf=38;5;13:*.axv=38;5;13:*.anx=38;5;13:*.ogv=38;5;13:*.ogx=38;5;13:*.aac=38;5;45:*.au=38;5;45:*.flac=38;5;45:*.mid=38;5;45:*.midi=38;5;45:*.mka=38;5;45:*.mp3=38;5;45:*.mpc=38;5;45:*.ogg=38;5;45:*.ra=38;5;45:*.wav=38;5;45:*.axa=38;5;45:*.oga=38;5;45:*.spx=38;5;45:*.xspf=38;5;45:', 'CONDA_EXE': '/home/aypan/miniconda3/bin/conda', 'SLURM_JOBID': '11241569', 'SLURM_NTASKS': '28', 'SESSION_MANAGER': 'local/unix:@/tmp/.ICE-unix/10443,unix/unix:/tmp/.ICE-unix/10443', 'TMUX': '/tmp/tmux-8901/default,19332,0', '_CE_CONDA': '', 'SLURM_TASKS_PER_NODE': '28', 'PATH': '/central/slurm/install/current/bin:/central/slurm/install/current/bin:/opt/TurboVNC/bin:/home/aypan/miniconda3/bin:/home/aypan/miniconda3/condabin:/central/slurm/install/current/bin:/usr/lib64/qt-3.3/bin:/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/usr/lpp/mmfs/bin:/opt/ibutils/bin:/opt/dell/srvadmin/bin:/home/aypan/.local/bin:/home/aypan/bin:/usr/lpp/mmfs/bin:/home/aypan/.local/bin:/home/aypan/bin:/usr/lpp/mmfs/bin:/home/aypan/.local/bin:/home/aypan/bin', 'MAIL': '/var/spool/mail/aypan', 'SLURM_CONF': '/central/slurm/etc/slurm.conf', 'SLURM_WORKING_CLUSTER': 'central:head1:6817:8960:109', 'SLURM_JOB_ID': '11241569', '_': '/home/aypan/miniconda3/bin/python3', 'CONDA_PREFIX': '/home/aypan/miniconda3', 'SLURM_JOB_USER': 'aypan', 'PWD': '/home/aypan/enc_dec', 'LANG': 'en_US.UTF-8', 'MODULEPATH': '/software/Modules/modulefiles/biology:/software/Modules/modulefiles/chemistry:/software/Modules/modulefiles/compilers:/software/Modules/modulefiles/data:/software/Modules/modulefiles/debuggers:/software/Modules/modulefiles/developement:/software/Modules/modulefiles/geo:/software/Modules/modulefiles/languages:/software/Modules/modulefiles/libraries:/software/Modules/modulefiles/math:/software/Modules/modulefiles/misc:/software/Modules/modulefiles/mpi:/software/Modules/modulefiles/profilers:/software/Modules/modulefiles/tools:/software/Modules/modulefiles/visualization:/software/Modules/modulefiles/testing:/software/Modules/modulefiles/cloud:/software/Modules/modulefiles/groups', 'SLURM_JOB_UID': '8901', 'LOADEDMODULES': '', 'SLURM_NODEID': '0', 'TMUX_PANE': '%0', 'SLURM_SUBMIT_DIR': '/central/home/aypan/enc_dec', 'SLURM_NPROCS': '28', 'SLURM_TASK_PID': '19852', 'SLURM_CPUS_ON_NODE': '28', 'ENVIRONMENT': 'BATCH', 'SLURM_PROCID': '0', 'HISTCONTROL': 'ignoredups', 'SSH_ASKPASS': '/usr/libexec/openssh/gnome-ssh-askpass', '_CE_M': '', 'SLURM_JOB_NODELIST': 'hpc-25-17', 'HOME': '/home/aypan', 'SHLVL': '6', 'SLURM_GET_USER_ENV': '1', 'SLURM_LOCALID': '0', 'SLURM_CLUSTER_NAME': 'central', 'SLURM_JOB_CPUS_PER_NODE': '28', 'SLURM_JOB_GID': '105', 'SLURM_GTIDS': '0', 'SLURM_SUBMIT_HOST': 'hpc-25-17.cm.cluster', 'SLURM_JOB_PARTITION': 'tensortest', 'LOGNAME': 'aypan', 'CONDA_PYTHON_EXE': '/home/aypan/miniconda3/bin/python', 'QTLIB': '/usr/lib64/qt-3.3/lib', 'DBUS_SESSION_BUS_ADDRESS': 'unix:abstract=/tmp/dbus-B4BXQIdeE6,guid=66cbe0c80c448e1bdb5548fc5f5e968b', 'SLURM_JOB_ACCOUNT': 'tensorlab', 'XDG_DATA_DIRS': '/home/aypan/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share', 'SLURM_JOB_NUM_NODES': '1', 'MODULESHOME': '/software/Modules', 'LESSOPEN': '||/usr/bin/lesspipe.sh %s', 'CONDA_DEFAULT_ENV': 'base', 'WEBSOCKIFY_CMD': '/usr/bin/websockify', 'port': '5901', 'DISPLAY': ':1.0', 'XDG_RUNTIME_DIR': '/run/user/8901', 'COLORTERM': 'truecolor', 'BASH_FUNC_port_used()': '() {  local port="${1#*:}";\n local host=$((expr "${1}" : \'\\(.*\\):\' || echo "localhost") | awk \'END{print $NF}\');\n nc -w 2 "${host}" "${port}" < /dev/null &>/dev/null\n}', 'BASH_FUNC_wait_until_port_used()': '() {  local port="${1}";\n local time="${2:-30}";\n for ((i=1; i<=time*2; i++))\n do\n if port_used "${port}"; then\n return 0;\n fi;\n sleep 0.5;\n done;\n return 1\n}', 'BASH_FUNC_module()': '() {  eval `/software/Modules/bin/modulecmd sh $*`\n}', 'BASH_FUNC_find_port()': '() {  local host="${1:-localhost}";\n local port=$(random_number "${2:-2000}" "${3:-65535}");\n while port_used "${host}:${port}"; do\n port=$(random_number "${2:-2000}" "${3:-65535}");\n done;\n echo "${port}"\n}', 'BASH_FUNC_random_number()': '() {  shuf -i ${1}-${2} -n 1\n}', 'BASH_FUNC_source_helpers()': '() {  function random_number () \n { \n shuf -i ${1}-${2} -n 1\n };\n export -f random_number;\n function port_used () \n { \n local port="${1#*:}";\n local host=$((expr "${1}" : \'\\(.*\\):\' || echo "localhost") | awk \'END{print $NF}\');\n nc -w 2 "${host}" "${port}" < /dev/null &>/dev/null\n };\n export -f port_used;\n function find_port () \n { \n local host="${1:-localhost}";\n local port=$(random_number "${2:-2000}" "${3:-65535}");\n while port_used "${host}:${port}"; do\n port=$(random_number "${2:-2000}" "${3:-65535}");\n done;\n echo "${port}"\n };\n export -f find_port;\n function wait_until_port_used () \n { \n local port="${1}";\n local time="${2:-30}";\n for ((i=1; i<=time*2; i++))\n do\n if port_used "${port}"; then\n return 0;\n fi;\n sleep 0.5;\n done;\n return 1\n };\n export -f wait_until_port_used;\n function create_passwd () \n { \n tr -cd \'a-zA-Z0-9\' < /dev/urandom 2> /dev/null | head -c${1:-8}\n };\n export -f create_passwd\n}', 'BASH_FUNC_create_passwd()': "() {  tr -cd 'a-zA-Z0-9' < /dev/urandom 2> /dev/null | head -c${1:-8}\n}"})
0 - Master address: hpc-25-17
0 - Master port   : 12001
0 - Number of nodes: 1
0 - Node ID					   : 0
0 - Local rank				   : 0
0 - Global rank    : 0
0 - World size				   : 28
0 - GPUs per node  : 28
0 - Master					   : True
0 - Multi-node				   : False
0 - Multi-GPU				   : True
0 - Hostname				   : hpc-25-17.cm.cluster
Initializing PyTorch distributed ...
Traceback (most recent call last):
  File "main.py", line 242, in <module>
    main(params)
  File "main.py", line 171, in main
    assert not params.multi_gpu
AssertionError
done
