SLURM job: True
0
0 - SLURM_JOB_ID: 10967961
0 - SLURM_JOB_NODELIST: hpc-25-17
0 - SLURM_JOB_NUM_NODES: 1
0 - SLURM_NTASKS: 1
0 - SLURM_TASKS_PER_NODE: 1
0 - SLURM_MEM_PER_NODE: None
0 - SLURM_MEM_PER_CPU: 4096
0 - SLURM_NODEID: 0
0 - SLURM_PROCID: 0
0 - SLURM_LOCALID: 0
0 - SLURM_TASK_PID: 22030
0
SLURM job: True
2
0 - SLURM_JOB_ID: 10967961
0 - SLURM_JOB_NODELIST: hpc-25-17
0 - SLURM_JOB_NUM_NODES: 1
0 - SLURM_NTASKS: 1
0 - SLURM_TASKS_PER_NODE: 1
0 - SLURM_MEM_PER_NODE: None
0 - SLURM_MEM_PER_CPU: 4096
0 - SLURM_NODEID: 0
0 - SLURM_PROCID: 0
0 - SLURM_LOCALID: 0
0 - SLURM_TASK_PID: 22030
0
SLURM job: True
1
0 - SLURM_JOB_ID: 10967961
0 - SLURM_JOB_NODELIST: hpc-25-17
0 - SLURM_JOB_NUM_NODES: 1
0 - SLURM_NTASKS: 1
0 - SLURM_TASKS_PER_NODE: 1
0 - SLURM_MEM_PER_NODE: None
0 - SLURM_MEM_PER_CPU: 4096
0 - SLURM_NODEID: 0
0 - SLURM_PROCID: 0
0 - SLURM_LOCALID: 0
0 - SLURM_TASK_PID: 22030
0
SLURM job: True
3
0 - SLURM_JOB_ID: 10967961
0 - SLURM_JOB_NODELIST: hpc-25-17
0 - SLURM_JOB_NUM_NODES: 1
0 - SLURM_NTASKS: 1
0 - SLURM_TASKS_PER_NODE: 1
0 - SLURM_MEM_PER_NODE: None
0 - SLURM_MEM_PER_CPU: 4096
0 - SLURM_NODEID: 0
0 - SLURM_PROCID: 0
0 - SLURM_LOCALID: 0
0 - SLURM_TASK_PID: 22030
0
0 - Master address: hpc-25-17
0 - Master port   : -1
0 - Number of nodes: 1
0 - Node ID			   : 0
0 - Local rank		   : 0
0 - Global rank    : 0
0 - World size		   : 1
0 - GPUs per node  : 1
0 - Master			   : True
0 - Multi-node		   : False
0 - Multi-GPU		   : False
0 - Hostname		   : hpc-25-17.cm.cluster
0 - Master address: hpc-25-17
0 - Master port   : -1
0 - Number of nodes: 1
0 - Node ID			   : 0
0 - Local rank		   : 0
0 - Global rank    : 0
0 - World size		   : 1
0 - GPUs per node  : 1
0 - Master			   : True
0 - Multi-node		   : False
0 - Multi-GPU		   : False
0 - Hostname		   : hpc-25-17.cm.cluster
0 - Master address: hpc-25-17
0 - Master port   : -1
0 - Number of nodes: 1
0 - Node ID			   : 0
0 - Local rank		   : 0
0 - Global rank    : 0
0 - World size		   : 1
0 - GPUs per node  : 1
0 - Master			   : True
0 - Multi-node		   : False
0 - Multi-GPU		   : False
0 - Hostname		   : hpc-25-17.cm.cluster
0 - Master address: hpc-25-17
0 - Master port   : -1
0 - Number of nodes: 1
0 - Node ID			   : 0
0 - Local rank		   : 0
0 - Global rank    : 0
0 - World size		   : 1
0 - GPUs per node  : 1
0 - Master			   : True
0 - Multi-node		   : False
0 - Multi-GPU		   : False
0 - Hostname		   : hpc-25-17.cm.cluster
INFO - 08/17/20 13:37:45 - 0:00:00 - ============ Initialized logger ============
INFO - 08/17/20 13:37:45 - 0:00:00 - accumulate_gradients: 1
                                     amp: -1
                                     attention_dropout: 0
                                     balanced: False
                                     batch_size: 32
                                     beam_early_stopping: True
                                     beam_eval: False
                                     beam_length_penalty: 1
                                     beam_size: 1
                                     clean_prefix_expr: True
                                     clip_grad_norm: 5
                                     command: python main.py --local_rank=0 --exp_name treelstm_noinit --tasks ode2 --reload_data 'ode2,ode2.train,ode2.valid,ode2.test' --reload_size 100 --emb_dim 256 --n_dec_layers 6 --n_heads 8 --dropout '0.1' --treelstm --symmetric --num_bit 10 --optimizer 'adam,lr=0.0001' --batch_size 32 --epoch_size 100 --max_epoch 10 --validation_metrics valid_ode2_acc --exp_id "10967961"
                                     cpu: False
                                     debug: False
                                     debug_slurm: False
                                     dropout: 0.1
                                     dump_path: ./dumped/treelstm_noinit/10967961
                                     emb_dim: 256
                                     env_base_seed: 0
                                     env_name: char_sp
                                     epoch_size: 100
                                     eval_only: False
                                     eval_verbose: 0
                                     eval_verbose_print: False
                                     exp_id: 10967961
                                     exp_name: treelstm_noinit
                                     export_data: False
                                     fp16: False
                                     global_rank: 0
                                     int_base: 10
                                     is_master: True
                                     is_slurm_job: True
                                     leaf_probs: 0.75,0,0.25,0
                                     local_rank: 0
                                     master_addr: hpc-25-17
                                     master_port: -1
                                     max_epoch: 10
                                     max_int: 10000
                                     max_len: 512
                                     max_ops: 10
                                     max_ops_G: 4
                                     multi_gpu: False
                                     multi_node: False
                                     n_coefficients: 0
                                     n_dec_layers: 6
                                     n_enc_layers: 4
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_nodes: 1
                                     n_variables: 1
                                     node_id: 0
                                     num_bit: 10
                                     num_workers: 10
                                     operators: add:2,sub:1
                                     optimizer: adam,lr=0.0001
                                     order: 1
                                     positive: False
                                     precision: 10
                                     reload_checkpoint: 
                                     reload_data: ode2,ode2.train,ode2.valid,ode2.test
                                     reload_model: 
                                     reload_size: 100
                                     rewrite_functions: 
                                     same_nb_ops_per_batch: False
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     stopping_criterion: 
                                     symmetric: True
                                     tasks: ode2
                                     treelstm: True
                                     validation_metrics: valid_ode2_acc
                                     vars: 1
                                     world_size: 1
INFO - 08/17/20 13:37:45 - 0:00:00 - The experiment will be stored in ./dumped/treelstm_noinit/10967961
                                     
INFO - 08/17/20 13:37:45 - 0:00:00 - Running command: python main.py --local_rank=0 --exp_name treelstm_noinit --tasks ode2 --reload_data 'ode2,ode2.train,ode2.valid,ode2.test' --reload_size 100 --emb_dim 256 --n_dec_layers 6 --n_heads 8 --dropout '0.1' --treelstm --symmetric --num_bit 10 --optimizer 'adam,lr=0.0001' --batch_size 32 --epoch_size 100 --max_epoch 10 --validation_metrics valid_ode2_acc

WARNING - 08/17/20 13:37:45 - 0:00:00 - Signal handler installed.
INFO - 08/17/20 13:37:45 - 0:00:00 - Unary operators: []
INFO - 08/17/20 13:37:45 - 0:00:00 - Binary operators: ['add', 'sub']
INFO - 08/17/20 13:37:45 - 0:00:00 - words: {'<s>': 0, '</s>': 1, '<pad>': 2, '(': 3, ')': 4, '<SPECIAL_5>': 5, '<SPECIAL_6>': 6, '<SPECIAL_7>': 7, '<SPECIAL_8>': 8, '<SPECIAL_9>': 9, 'pi': 10, 'E': 11, 'x': 12, 'y': 13, 'z': 14, 't': 15, 'a0': 16, 'a1': 17, 'a2': 18, 'a3': 19, 'a4': 20, 'a5': 21, 'a6': 22, 'a7': 23, 'a8': 24, 'a9': 25, 'abs': 26, 'acos': 27, 'acosh': 28, 'acot': 29, 'acoth': 30, 'acsc': 31, 'acsch': 32, 'add': 33, 'asec': 34, 'asech': 35, 'asin': 36, 'asinh': 37, 'atan': 38, 'atanh': 39, 'cos': 40, 'cosh': 41, 'cot': 42, 'coth': 43, 'csc': 44, 'csch': 45, 'derivative': 46, 'div': 47, 'exp': 48, 'f': 49, 'g': 50, 'h': 51, 'inv': 52, 'ln': 53, 'mul': 54, 'pow': 55, 'pow2': 56, 'pow3': 57, 'pow4': 58, 'pow5': 59, 'rac': 60, 'sec': 61, 'sech': 62, 'sign': 63, 'sin': 64, 'sinh': 65, 'sqrt': 66, 'sub': 67, 'tan': 68, 'tanh': 69, 'I': 70, 'INT+': 71, 'INT-': 72, 'INT': 73, 'FLOAT': 74, '-': 75, '.': 76, '10^': 77, 'Y': 78, "Y'": 79, "Y''": 80, '0': 81, '1': 82, '2': 83, '3': 84, '4': 85, '5': 86, '6': 87, '7': 88, '8': 89, '9': 90}
INFO - 08/17/20 13:37:45 - 0:00:00 - 20001 possible leaves.
INFO - 08/17/20 13:37:45 - 0:00:00 - Checking expressions in [0.01, 0.1, 0.3, 0.5, 0.7, 0.9, 1.1, 2.1, 3.1, -0.01, -0.1, -0.3, -0.5, -0.7, -0.9, -1.1, -2.1, -3.1]
INFO - 08/17/20 13:37:45 - 0:00:00 - Training tasks: ode2
INFO - 08/17/20 13:37:45 - 0:00:00 - ============ Initialized logger ============
INFO - 08/17/20 13:37:45 - 0:00:00 - accumulate_gradients: 1
                                     amp: -1
                                     attention_dropout: 0
                                     balanced: False
                                     batch_size: 32
                                     beam_early_stopping: True
                                     beam_eval: False
                                     beam_length_penalty: 1
                                     beam_size: 1
                                     clean_prefix_expr: True
                                     clip_grad_norm: 5
                                     command: python main.py --local_rank=1 --exp_name treelstm_noinit --tasks ode2 --reload_data 'ode2,ode2.train,ode2.valid,ode2.test' --reload_size 100 --emb_dim 256 --n_dec_layers 6 --n_heads 8 --dropout '0.1' --treelstm --symmetric --num_bit 10 --optimizer 'adam,lr=0.0001' --batch_size 32 --epoch_size 100 --max_epoch 10 --validation_metrics valid_ode2_acc --exp_id "10967961"
                                     cpu: False
                                     debug: False
                                     debug_slurm: False
                                     dropout: 0.1
                                     dump_path: ./dumped/treelstm_noinit/10967961
                                     emb_dim: 256
                                     env_base_seed: 0
                                     env_name: char_sp
                                     epoch_size: 100
                                     eval_only: False
                                     eval_verbose: 0
                                     eval_verbose_print: False
                                     exp_id: 10967961
                                     exp_name: treelstm_noinit
                                     export_data: False
                                     fp16: False
                                     global_rank: 0
                                     int_base: 10
                                     is_master: True
                                     is_slurm_job: True
                                     leaf_probs: 0.75,0,0.25,0
                                     local_rank: 0
                                     master_addr: hpc-25-17
                                     master_port: -1
                                     max_epoch: 10
                                     max_int: 10000
                                     max_len: 512
                                     max_ops: 10
                                     max_ops_G: 4
                                     multi_gpu: False
                                     multi_node: False
                                     n_coefficients: 0
                                     n_dec_layers: 6
                                     n_enc_layers: 4
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_nodes: 1
                                     n_variables: 1
                                     node_id: 0
                                     num_bit: 10
                                     num_workers: 10
                                     operators: add:2,sub:1
                                     optimizer: adam,lr=0.0001
                                     order: 1
                                     positive: False
                                     precision: 10
                                     reload_checkpoint: 
                                     reload_data: ode2,ode2.train,ode2.valid,ode2.test
                                     reload_model: 
                                     reload_size: 100
                                     rewrite_functions: 
                                     same_nb_ops_per_batch: False
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     stopping_criterion: 
                                     symmetric: True
                                     tasks: ode2
                                     treelstm: True
                                     validation_metrics: valid_ode2_acc
                                     vars: 1
                                     world_size: 1
INFO - 08/17/20 13:37:45 - 0:00:00 - The experiment will be stored in ./dumped/treelstm_noinit/10967961
                                     
INFO - 08/17/20 13:37:45 - 0:00:00 - Running command: python main.py --local_rank=1 --exp_name treelstm_noinit --tasks ode2 --reload_data 'ode2,ode2.train,ode2.valid,ode2.test' --reload_size 100 --emb_dim 256 --n_dec_layers 6 --n_heads 8 --dropout '0.1' --treelstm --symmetric --num_bit 10 --optimizer 'adam,lr=0.0001' --batch_size 32 --epoch_size 100 --max_epoch 10 --validation_metrics valid_ode2_acc

WARNING - 08/17/20 13:37:45 - 0:00:00 - Signal handler installed.
INFO - 08/17/20 13:37:45 - 0:00:00 - Unary operators: []
INFO - 08/17/20 13:37:45 - 0:00:00 - Binary operators: ['add', 'sub']
INFO - 08/17/20 13:37:45 - 0:00:00 - words: {'<s>': 0, '</s>': 1, '<pad>': 2, '(': 3, ')': 4, '<SPECIAL_5>': 5, '<SPECIAL_6>': 6, '<SPECIAL_7>': 7, '<SPECIAL_8>': 8, '<SPECIAL_9>': 9, 'pi': 10, 'E': 11, 'x': 12, 'y': 13, 'z': 14, 't': 15, 'a0': 16, 'a1': 17, 'a2': 18, 'a3': 19, 'a4': 20, 'a5': 21, 'a6': 22, 'a7': 23, 'a8': 24, 'a9': 25, 'abs': 26, 'acos': 27, 'acosh': 28, 'acot': 29, 'acoth': 30, 'acsc': 31, 'acsch': 32, 'add': 33, 'asec': 34, 'asech': 35, 'asin': 36, 'asinh': 37, 'atan': 38, 'atanh': 39, 'cos': 40, 'cosh': 41, 'cot': 42, 'coth': 43, 'csc': 44, 'csch': 45, 'derivative': 46, 'div': 47, 'exp': 48, 'f': 49, 'g': 50, 'h': 51, 'inv': 52, 'ln': 53, 'mul': 54, 'pow': 55, 'pow2': 56, 'pow3': 57, 'pow4': 58, 'pow5': 59, 'rac': 60, 'sec': 61, 'sech': 62, 'sign': 63, 'sin': 64, 'sinh': 65, 'sqrt': 66, 'sub': 67, 'tan': 68, 'tanh': 69, 'I': 70, 'INT+': 71, 'INT-': 72, 'INT': 73, 'FLOAT': 74, '-': 75, '.': 76, '10^': 77, 'Y': 78, "Y'": 79, "Y''": 80, '0': 81, '1': 82, '2': 83, '3': 84, '4': 85, '5': 86, '6': 87, '7': 88, '8': 89, '9': 90}
INFO - 08/17/20 13:37:45 - 0:00:00 - 20001 possible leaves.
INFO - 08/17/20 13:37:45 - 0:00:00 - Checking expressions in [0.01, 0.1, 0.3, 0.5, 0.7, 0.9, 1.1, 2.1, 3.1, -0.01, -0.1, -0.3, -0.5, -0.7, -0.9, -1.1, -2.1, -3.1]
INFO - 08/17/20 13:37:45 - 0:00:00 - Training tasks: ode2
INFO - 08/17/20 13:37:45 - 0:00:00 - ============ Initialized logger ============
INFO - 08/17/20 13:37:45 - 0:00:00 - accumulate_gradients: 1
                                     amp: -1
                                     attention_dropout: 0
                                     balanced: False
                                     batch_size: 32
                                     beam_early_stopping: True
                                     beam_eval: False
                                     beam_length_penalty: 1
                                     beam_size: 1
                                     clean_prefix_expr: True
                                     clip_grad_norm: 5
                                     command: python main.py --local_rank=2 --exp_name treelstm_noinit --tasks ode2 --reload_data 'ode2,ode2.train,ode2.valid,ode2.test' --reload_size 100 --emb_dim 256 --n_dec_layers 6 --n_heads 8 --dropout '0.1' --treelstm --symmetric --num_bit 10 --optimizer 'adam,lr=0.0001' --batch_size 32 --epoch_size 100 --max_epoch 10 --validation_metrics valid_ode2_acc --exp_id "10967961"
                                     cpu: False
                                     debug: False
                                     debug_slurm: False
                                     dropout: 0.1
                                     dump_path: ./dumped/treelstm_noinit/10967961
                                     emb_dim: 256
                                     env_base_seed: 0
                                     env_name: char_sp
                                     epoch_size: 100
                                     eval_only: False
                                     eval_verbose: 0
                                     eval_verbose_print: False
                                     exp_id: 10967961
                                     exp_name: treelstm_noinit
                                     export_data: False
                                     fp16: False
                                     global_rank: 0
                                     int_base: 10
                                     is_master: True
                                     is_slurm_job: True
                                     leaf_probs: 0.75,0,0.25,0
                                     local_rank: 0
                                     master_addr: hpc-25-17
                                     master_port: -1
                                     max_epoch: 10
                                     max_int: 10000
                                     max_len: 512
                                     max_ops: 10
                                     max_ops_G: 4
                                     multi_gpu: False
                                     multi_node: False
                                     n_coefficients: 0
                                     n_dec_layers: 6
                                     n_enc_layers: 4
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_nodes: 1
                                     n_variables: 1
                                     node_id: 0
                                     num_bit: 10
                                     num_workers: 10
                                     operators: add:2,sub:1
                                     optimizer: adam,lr=0.0001
                                     order: 1
                                     positive: False
                                     precision: 10
                                     reload_checkpoint: 
                                     reload_data: ode2,ode2.train,ode2.valid,ode2.test
                                     reload_model: 
                                     reload_size: 100
                                     rewrite_functions: 
                                     same_nb_ops_per_batch: False
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     stopping_criterion: 
                                     symmetric: True
                                     tasks: ode2
                                     treelstm: True
                                     validation_metrics: valid_ode2_acc
                                     vars: 1
                                     world_size: 1
INFO - 08/17/20 13:37:45 - 0:00:00 - The experiment will be stored in ./dumped/treelstm_noinit/10967961
                                     
INFO - 08/17/20 13:37:45 - 0:00:00 - Running command: python main.py --local_rank=2 --exp_name treelstm_noinit --tasks ode2 --reload_data 'ode2,ode2.train,ode2.valid,ode2.test' --reload_size 100 --emb_dim 256 --n_dec_layers 6 --n_heads 8 --dropout '0.1' --treelstm --symmetric --num_bit 10 --optimizer 'adam,lr=0.0001' --batch_size 32 --epoch_size 100 --max_epoch 10 --validation_metrics valid_ode2_acc

WARNING - 08/17/20 13:37:45 - 0:00:00 - Signal handler installed.
INFO - 08/17/20 13:37:45 - 0:00:00 - Unary operators: []
INFO - 08/17/20 13:37:45 - 0:00:00 - Binary operators: ['add', 'sub']
INFO - 08/17/20 13:37:45 - 0:00:00 - words: {'<s>': 0, '</s>': 1, '<pad>': 2, '(': 3, ')': 4, '<SPECIAL_5>': 5, '<SPECIAL_6>': 6, '<SPECIAL_7>': 7, '<SPECIAL_8>': 8, '<SPECIAL_9>': 9, 'pi': 10, 'E': 11, 'x': 12, 'y': 13, 'z': 14, 't': 15, 'a0': 16, 'a1': 17, 'a2': 18, 'a3': 19, 'a4': 20, 'a5': 21, 'a6': 22, 'a7': 23, 'a8': 24, 'a9': 25, 'abs': 26, 'acos': 27, 'acosh': 28, 'acot': 29, 'acoth': 30, 'acsc': 31, 'acsch': 32, 'add': 33, 'asec': 34, 'asech': 35, 'asin': 36, 'asinh': 37, 'atan': 38, 'atanh': 39, 'cos': 40, 'cosh': 41, 'cot': 42, 'coth': 43, 'csc': 44, 'csch': 45, 'derivative': 46, 'div': 47, 'exp': 48, 'f': 49, 'g': 50, 'h': 51, 'inv': 52, 'ln': 53, 'mul': 54, 'pow': 55, 'pow2': 56, 'pow3': 57, 'pow4': 58, 'pow5': 59, 'rac': 60, 'sec': 61, 'sech': 62, 'sign': 63, 'sin': 64, 'sinh': 65, 'sqrt': 66, 'sub': 67, 'tan': 68, 'tanh': 69, 'I': 70, 'INT+': 71, 'INT-': 72, 'INT': 73, 'FLOAT': 74, '-': 75, '.': 76, '10^': 77, 'Y': 78, "Y'": 79, "Y''": 80, '0': 81, '1': 82, '2': 83, '3': 84, '4': 85, '5': 86, '6': 87, '7': 88, '8': 89, '9': 90}
INFO - 08/17/20 13:37:45 - 0:00:00 - 20001 possible leaves.
INFO - 08/17/20 13:37:45 - 0:00:00 - Checking expressions in [0.01, 0.1, 0.3, 0.5, 0.7, 0.9, 1.1, 2.1, 3.1, -0.01, -0.1, -0.3, -0.5, -0.7, -0.9, -1.1, -2.1, -3.1]
INFO - 08/17/20 13:37:45 - 0:00:00 - Training tasks: ode2
INFO - 08/17/20 13:37:45 - 0:00:00 - ============ Initialized logger ============
INFO - 08/17/20 13:37:45 - 0:00:00 - accumulate_gradients: 1
                                     amp: -1
                                     attention_dropout: 0
                                     balanced: False
                                     batch_size: 32
                                     beam_early_stopping: True
                                     beam_eval: False
                                     beam_length_penalty: 1
                                     beam_size: 1
                                     clean_prefix_expr: True
                                     clip_grad_norm: 5
                                     command: python main.py --local_rank=3 --exp_name treelstm_noinit --tasks ode2 --reload_data 'ode2,ode2.train,ode2.valid,ode2.test' --reload_size 100 --emb_dim 256 --n_dec_layers 6 --n_heads 8 --dropout '0.1' --treelstm --symmetric --num_bit 10 --optimizer 'adam,lr=0.0001' --batch_size 32 --epoch_size 100 --max_epoch 10 --validation_metrics valid_ode2_acc --exp_id "10967961"
                                     cpu: False
                                     debug: False
                                     debug_slurm: False
                                     dropout: 0.1
                                     dump_path: ./dumped/treelstm_noinit/10967961
                                     emb_dim: 256
                                     env_base_seed: 0
                                     env_name: char_sp
                                     epoch_size: 100
                                     eval_only: False
                                     eval_verbose: 0
                                     eval_verbose_print: False
                                     exp_id: 10967961
                                     exp_name: treelstm_noinit
                                     export_data: False
                                     fp16: False
                                     global_rank: 0
                                     int_base: 10
                                     is_master: True
                                     is_slurm_job: True
                                     leaf_probs: 0.75,0,0.25,0
                                     local_rank: 0
                                     master_addr: hpc-25-17
                                     master_port: -1
                                     max_epoch: 10
                                     max_int: 10000
                                     max_len: 512
                                     max_ops: 10
                                     max_ops_G: 4
                                     multi_gpu: False
                                     multi_node: False
                                     n_coefficients: 0
                                     n_dec_layers: 6
                                     n_enc_layers: 4
                                     n_gpu_per_node: 1
                                     n_heads: 8
                                     n_nodes: 1
                                     n_variables: 1
                                     node_id: 0
                                     num_bit: 10
                                     num_workers: 10
                                     operators: add:2,sub:1
                                     optimizer: adam,lr=0.0001
                                     order: 1
                                     positive: False
                                     precision: 10
                                     reload_checkpoint: 
                                     reload_data: ode2,ode2.train,ode2.valid,ode2.test
                                     reload_model: 
                                     reload_size: 100
                                     rewrite_functions: 
                                     same_nb_ops_per_batch: False
                                     save_periodic: 0
                                     share_inout_emb: True
                                     sinusoidal_embeddings: False
                                     stopping_criterion: 
                                     symmetric: True
                                     tasks: ode2
                                     treelstm: True
                                     validation_metrics: valid_ode2_acc
                                     vars: 1
                                     world_size: 1
INFO - 08/17/20 13:37:45 - 0:00:00 - The experiment will be stored in ./dumped/treelstm_noinit/10967961
                                     
INFO - 08/17/20 13:37:45 - 0:00:00 - Running command: python main.py --local_rank=3 --exp_name treelstm_noinit --tasks ode2 --reload_data 'ode2,ode2.train,ode2.valid,ode2.test' --reload_size 100 --emb_dim 256 --n_dec_layers 6 --n_heads 8 --dropout '0.1' --treelstm --symmetric --num_bit 10 --optimizer 'adam,lr=0.0001' --batch_size 32 --epoch_size 100 --max_epoch 10 --validation_metrics valid_ode2_acc

WARNING - 08/17/20 13:37:45 - 0:00:00 - Signal handler installed.
INFO - 08/17/20 13:37:45 - 0:00:00 - Unary operators: []
INFO - 08/17/20 13:37:45 - 0:00:00 - Binary operators: ['add', 'sub']
INFO - 08/17/20 13:37:45 - 0:00:00 - words: {'<s>': 0, '</s>': 1, '<pad>': 2, '(': 3, ')': 4, '<SPECIAL_5>': 5, '<SPECIAL_6>': 6, '<SPECIAL_7>': 7, '<SPECIAL_8>': 8, '<SPECIAL_9>': 9, 'pi': 10, 'E': 11, 'x': 12, 'y': 13, 'z': 14, 't': 15, 'a0': 16, 'a1': 17, 'a2': 18, 'a3': 19, 'a4': 20, 'a5': 21, 'a6': 22, 'a7': 23, 'a8': 24, 'a9': 25, 'abs': 26, 'acos': 27, 'acosh': 28, 'acot': 29, 'acoth': 30, 'acsc': 31, 'acsch': 32, 'add': 33, 'asec': 34, 'asech': 35, 'asin': 36, 'asinh': 37, 'atan': 38, 'atanh': 39, 'cos': 40, 'cosh': 41, 'cot': 42, 'coth': 43, 'csc': 44, 'csch': 45, 'derivative': 46, 'div': 47, 'exp': 48, 'f': 49, 'g': 50, 'h': 51, 'inv': 52, 'ln': 53, 'mul': 54, 'pow': 55, 'pow2': 56, 'pow3': 57, 'pow4': 58, 'pow5': 59, 'rac': 60, 'sec': 61, 'sech': 62, 'sign': 63, 'sin': 64, 'sinh': 65, 'sqrt': 66, 'sub': 67, 'tan': 68, 'tanh': 69, 'I': 70, 'INT+': 71, 'INT-': 72, 'INT': 73, 'FLOAT': 74, '-': 75, '.': 76, '10^': 77, 'Y': 78, "Y'": 79, "Y''": 80, '0': 81, '1': 82, '2': 83, '3': 84, '4': 85, '5': 86, '6': 87, '7': 88, '8': 89, '9': 90}
INFO - 08/17/20 13:37:45 - 0:00:00 - 20001 possible leaves.
INFO - 08/17/20 13:37:45 - 0:00:00 - Checking expressions in [0.01, 0.1, 0.3, 0.5, 0.7, 0.9, 1.1, 2.1, 3.1, -0.01, -0.1, -0.3, -0.5, -0.7, -0.9, -1.1, -2.1, -3.1]
INFO - 08/17/20 13:37:45 - 0:00:00 - Training tasks: ode2
INFO - 08/17/20 13:37:46 - 0:00:01 - Number of parameters (encoder): 14867712
INFO - 08/17/20 13:37:46 - 0:00:01 - Number of parameters (decoder): 7393115
INFO - 08/17/20 13:37:46 - 0:00:01 - Number of parameters (encoder): 14867712
INFO - 08/17/20 13:37:46 - 0:00:01 - Number of parameters (decoder): 7393115
INFO - 08/17/20 13:37:46 - 0:00:01 - Number of parameters (encoder): 14867712
INFO - 08/17/20 13:37:46 - 0:00:01 - Number of parameters (decoder): 7393115
INFO - 08/17/20 13:37:46 - 0:00:01 - Number of parameters (encoder): 14867712
INFO - 08/17/20 13:37:46 - 0:00:01 - Number of parameters (decoder): 7393115
INFO - 08/17/20 13:37:57 - 0:00:12 - Found 583 parameters in model.
INFO - 08/17/20 13:37:57 - 0:00:12 - Found 583 parameters in model.
INFO - 08/17/20 13:37:57 - 0:00:12 - Optimizers: model
INFO - 08/17/20 13:37:57 - 0:00:12 - Optimizers: model
INFO - 08/17/20 13:37:57 - 0:00:12 - Creating train iterator for ode2 ...
INFO - 08/17/20 13:37:57 - 0:00:12 - Creating train iterator for ode2 ...
INFO - 08/17/20 13:37:57 - 0:00:12 - Loading data from ode2.train ...
INFO - 08/17/20 13:37:57 - 0:00:12 - Loading data from ode2.train ...
INFO - 08/17/20 13:37:57 - 0:00:12 - Loaded 100 equations from the disk.
INFO - 08/17/20 13:37:57 - 0:00:12 - Loaded 100 equations from the disk.
INFO - 08/17/20 13:37:58 - 0:00:12 - ============ Starting epoch 0 ... ============
INFO - 08/17/20 13:37:58 - 0:00:12 - ============ Starting epoch 0 ... ============
INFO - 08/17/20 13:37:58 - 0:00:12 - Initialized random generator for worker 0, with seed [0, 0, 0] (base seed=0).
INFO - 08/17/20 13:37:58 - 0:00:12 - Initialized random generator for worker 0, with seed [0, 0, 0] (base seed=0).
Traceback (most recent call last):
  File "main.py", line 242, in <module>
Traceback (most recent call last):
  File "main.py", line 242, in <module>
    main(params)
  File "main.py", line 205, in main
    trainer.enc_dec_step(task)
  File "/central/home/aypan/enc_dec/src/trainer.py", line 456, in enc_dec_step
    encoded, lengths, valid = encoder(x=xword, causal=False)
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    main(params)
  File "main.py", line 205, in main
    trainer.enc_dec_step(task)
  File "/central/home/aypan/enc_dec/src/trainer.py", line 456, in enc_dec_step
    encoded, lengths, valid = encoder(x=xword, causal=False)
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    result = self.forward(*input, **kwargs)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 687, in forward
    result = self.forward(*input, **kwargs)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 687, in forward
    batch, id2emb, lengths, invalid = self.prefix_to_tree(x)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 798, in prefix_to_tree
    batch, id2emb, lengths, invalid = self.prefix_to_tree(x)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 798, in prefix_to_tree
    tree, id2emb, _, counter, valid = self._prefix_to_tree(token_list[i], [], counter=counter)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 821, in _prefix_to_tree
    tree, id2emb, _, counter, valid = self._prefix_to_tree(token_list[i], [], counter=counter)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 821, in _prefix_to_tree
    left, _, idx, counter, valid = self._prefix_to_tree(tokens, id2emb, idx=idx, counter=counter)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 816, in _prefix_to_tree
    left, _, idx, counter, valid = self._prefix_to_tree(tokens, id2emb, idx=idx, counter=counter)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 816, in _prefix_to_tree
    left, _, idx, counter, valid1 = self._prefix_to_tree(tokens, id2emb, idx=idx, counter=counter)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 816, in _prefix_to_tree
    left, _, idx, counter, valid1 = self._prefix_to_tree(tokens, id2emb, idx=idx, counter=counter)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 816, in _prefix_to_tree
    left, _, idx, counter, valid1 = self._prefix_to_tree(tokens, id2emb, idx=idx, counter=counter)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 831, in _prefix_to_tree
    left, _, idx, counter, valid1 = self._prefix_to_tree(tokens, id2emb, idx=idx, counter=counter)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 831, in _prefix_to_tree
    root = BinaryEqnTree(token, BinaryEqnTree(val, None, None, value=self.int_emb(int(val))), None)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 760, in int_emb
    root = BinaryEqnTree(token, BinaryEqnTree(val, None, None, value=self.int_emb(int(val))), None)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 760, in int_emb
    return torch.sum(self.bin2emb(place), 0)
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    return torch.sum(self.bin2emb(place), 0)
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    result = self.forward(*input, **kwargs)
    result = self.forward(*input, **kwargs)
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/modules/sparse.py", line 114, in forward
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/modules/sparse.py", line 114, in forward
    self.norm_type, self.scale_grad_by_freq, self.sparse)
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/functional.py", line 1724, in embedding
    self.norm_type, self.scale_grad_by_freq, self.sparse)
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/functional.py", line 1724, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected object of device type cuda but got device type cpu for argument #3 'index' in call to _th_index_select
RuntimeError: Expected object of device type cuda but got device type cpu for argument #3 'index' in call to _th_index_select
INFO - 08/17/20 13:37:58 - 0:00:13 - Found 583 parameters in model.
INFO - 08/17/20 13:37:58 - 0:00:13 - Optimizers: model
INFO - 08/17/20 13:37:58 - 0:00:13 - Creating train iterator for ode2 ...
INFO - 08/17/20 13:37:58 - 0:00:13 - Loading data from ode2.train ...
INFO - 08/17/20 13:37:58 - 0:00:13 - Loaded 100 equations from the disk.
INFO - 08/17/20 13:37:58 - 0:00:13 - ============ Starting epoch 0 ... ============
INFO - 08/17/20 13:37:58 - 0:00:13 - Initialized random generator for worker 0, with seed [0, 0, 0] (base seed=0).
Traceback (most recent call last):
  File "main.py", line 242, in <module>
    main(params)
  File "main.py", line 205, in main
    trainer.enc_dec_step(task)
  File "/central/home/aypan/enc_dec/src/trainer.py", line 456, in enc_dec_step
    encoded, lengths, valid = encoder(x=xword, causal=False)
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    result = self.forward(*input, **kwargs)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 687, in forward
    batch, id2emb, lengths, invalid = self.prefix_to_tree(x)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 798, in prefix_to_tree
    tree, id2emb, _, counter, valid = self._prefix_to_tree(token_list[i], [], counter=counter)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 821, in _prefix_to_tree
    left, _, idx, counter, valid = self._prefix_to_tree(tokens, id2emb, idx=idx, counter=counter)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 816, in _prefix_to_tree
    left, _, idx, counter, valid1 = self._prefix_to_tree(tokens, id2emb, idx=idx, counter=counter)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 816, in _prefix_to_tree
    left, _, idx, counter, valid1 = self._prefix_to_tree(tokens, id2emb, idx=idx, counter=counter)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 831, in _prefix_to_tree
    root = BinaryEqnTree(token, BinaryEqnTree(val, None, None, value=self.int_emb(int(val))), None)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 760, in int_emb
    return torch.sum(self.bin2emb(place), 0)
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/modules/sparse.py", line 114, in forward
    self.norm_type, self.scale_grad_by_freq, self.sparse)
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/functional.py", line 1724, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected object of device type cuda but got device type cpu for argument #3 'index' in call to _th_index_select
INFO - 08/17/20 13:37:59 - 0:00:13 - Found 583 parameters in model.
INFO - 08/17/20 13:37:59 - 0:00:14 - Optimizers: model
INFO - 08/17/20 13:37:59 - 0:00:14 - Creating train iterator for ode2 ...
INFO - 08/17/20 13:37:59 - 0:00:14 - Loading data from ode2.train ...
INFO - 08/17/20 13:37:59 - 0:00:14 - Loaded 100 equations from the disk.
INFO - 08/17/20 13:37:59 - 0:00:14 - ============ Starting epoch 0 ... ============
INFO - 08/17/20 13:37:59 - 0:00:14 - Initialized random generator for worker 0, with seed [0, 0, 0] (base seed=0).
Traceback (most recent call last):
  File "main.py", line 242, in <module>
    main(params)
  File "main.py", line 205, in main
    trainer.enc_dec_step(task)
  File "/central/home/aypan/enc_dec/src/trainer.py", line 456, in enc_dec_step
    encoded, lengths, valid = encoder(x=xword, causal=False)
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    result = self.forward(*input, **kwargs)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 687, in forward
    batch, id2emb, lengths, invalid = self.prefix_to_tree(x)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 798, in prefix_to_tree
    tree, id2emb, _, counter, valid = self._prefix_to_tree(token_list[i], [], counter=counter)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 821, in _prefix_to_tree
    left, _, idx, counter, valid = self._prefix_to_tree(tokens, id2emb, idx=idx, counter=counter)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 816, in _prefix_to_tree
    left, _, idx, counter, valid1 = self._prefix_to_tree(tokens, id2emb, idx=idx, counter=counter)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 816, in _prefix_to_tree
    left, _, idx, counter, valid1 = self._prefix_to_tree(tokens, id2emb, idx=idx, counter=counter)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 831, in _prefix_to_tree
    root = BinaryEqnTree(token, BinaryEqnTree(val, None, None, value=self.int_emb(int(val))), None)
  File "/central/home/aypan/enc_dec/src/model/transformer.py", line 760, in int_emb
    return torch.sum(self.bin2emb(place), 0)
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/modules/module.py", line 550, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/modules/sparse.py", line 114, in forward
    self.norm_type, self.scale_grad_by_freq, self.sparse)
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/nn/functional.py", line 1724, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected object of device type cuda but got device type cpu for argument #3 'index' in call to _th_index_select
Traceback (most recent call last):
  File "/home/aypan/miniconda3/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/aypan/miniconda3/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/distributed/launch.py", line 263, in <module>
    main()
  File "/home/aypan/miniconda3/lib/python3.7/site-packages/torch/distributed/launch.py", line 259, in main
    cmd=cmd)
subprocess.CalledProcessError: Command '['/home/aypan/miniconda3/bin/python3', '-u', 'main.py', '--local_rank=3', '--exp_name', 'treelstm_noinit', '--tasks', 'ode2', '--reload_data', 'ode2,ode2.train,ode2.valid,ode2.test', '--reload_size', '100', '--emb_dim', '256', '--n_dec_layers', '6', '--n_heads', '8', '--dropout', '0.1', '--treelstm', '--symmetric', '--num_bit', '10', '--optimizer', 'adam,lr=0.0001', '--batch_size', '32', '--epoch_size', '100', '--max_epoch', '10', '--validation_metrics', 'valid_ode2_acc']' returned non-zero exit status 1.
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
done
